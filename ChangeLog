2009-06-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Make sure the string
	written does not exceed the maximum buffer size.

2009-06-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Added
	support of subdirectories).

2009-06-08  Michael Wiegand <michael.wiegand@intevation.de>

	* MANIFEST: Added missing entries.

2009-06-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store.c (store_dump_plugin): Removed. This
	function was deactivated anyway.

2009-06-05  Matthew Mundell <mmundell@intevation.de>

	* src/libopenvas/network.c (open_SSL_connection)
	(ovas_server_context_attach): Remove EAGAIN and EINTR checks added on
	2008-11-17 (revision 1769), as GNU TLS always returns its own error
	codes.

2009-06-05  Matthew Mundell <mmundell@intevation.de>

	Improve naming of nvtis functions.

	* libopenvascommon/nvti.c (nvtis_new, nvtis_free, nvtis_add)
	(nvtis_lookup): New functions, renamed from make_nvtis, free_nvtis,
	add_nvti and find_nvti.
	(make_nvtis, free_nvtis, add_nvti, find_nvti): Remove.
	* libopenvascommon/nvti.h: Update headers.

2009-06-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (plug_set_sign_key_ids): If
	the key_ids are NULL, then don't add "SIGN_KEY_IDS" to the
	plugin description at all.

2009-06-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvtpref_add_to_keyfile): Removed
	this callback function as it is not needed anymore.
	(nvti_to_keyfile): Create generic keys "P1" .. "Pn" instead
	of using the preferences names, because those can sometimes
	contain chracters that are invalid for keys.
	Also, replace fprintf by fputs to avoid interpretation of %.

2009-05-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.h: Added data structure nvtpref_t and
	associated functionprotos for handling NVT preferences.
	(nvti_t): Extended to handle its preferences.

	* libopenvascommon/nvti.c (nvtpref_new, nvtpref_free,
	nvtpref_name, nvtpref_type, nvtpref_default): New. For
	handling nvtpref objects.
	(nvti_free, nvti_from_keyfile, nvti_to_keyfile): Handle
	preferences accordingly.
	(nvti_pref_len, nvti_pref, nvti_add_pref,
	nvtpref_add_to_keyfile): New.
	(nvti_to_keyfile): Fix bug: release text only when it is
	really allocated.

2009-05-29  Matthew Mundell <mmundell@intevation.de>

	Add certificate facilities.

	* libopenvascommon/certificate.h, libopenvascommon/certificate.c: New
	files.

	* libopenvas/Makefile: Add libopenvascommon/certificate.

	* Makefile: Install libopenvascommon/certificate.h.

2009-05-28  Matthew Mundell <mmundell@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Rename gerror to error.  Free
	error after use.  Add error->message to error message.

2009-05-28  Matthew Mundell <mmundell@intevation.de>

	Add type nvtis for collections of NVT Infos.

	* libopenvascommon/nvti.c (free_nvti_for_hash_table, make_nvtis)
	(free_nvtis, nvtis_size, add_nvti, find_nvti): New functions.

	* libopenvascommon/nvti.h: Update headers.  Add single include guard.

	* ChangeLog: Add log missed yesterday.

2009-05-28  Felix Wolfsteller  <felix.wolfsteller@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Fixed mem leak by freeing
	text, added TODO as function returns 0 also in case of errors.

2009-05-27  Matthew Mundell <mmundell@intevation.de>

	* Makefile (install): Install libopenvascommon/nvti.h.

2009-05-27  Matthew Mundell <mmundell@intevation.de>

	* libopenvascommon/nvti.c: Correct function name.

2009-05-27  Matthew Mundell <mmundell@intevation.de>

	* libopenvascommon/nvti.h, libopenvascommon/nvti.c: Reformat to match
	standard.

2009-05-27  Matthew Mundell <mmundell@intevation.de>

	* ChangeLog: Flush trailing whitespace.

2009-05-27  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	Adding initial support for logging.

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h: New.
	Shared logging functions.

	* libopenvas/Makefile openvas-libraries.tmpl.in Makefile: Updated.

	* MANIFEST: Updated.

2009-05-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adding a initial version for NVT Info objects.

	* libopenvascommon/, libopenvascommon/nvti.h,
	libopenvascommon/nvti.c, libopenvascommon/README.txt: New.
	A module for handling NVT Info objects.

	* libopenvas/Makefile: Added handling of module
	"libopenvascommon/nvti".

	* MANIFEST: Updated.

2009-05-19  Matthew Mundell <mmundell@intevation.de>

	Add authentication facilities.

	* libopenvas/openvas_auth.c: New file.  Contains functions digest_hex and
	get_password_hashes from ../config-manager/src/openvascd.c.
	* libopenvas/openvas_auth.h: New file.

	* libopenvas/Makefile (openvas_auth.o): New rule.

	* Makefile (install): Add openvas_auth.h.
	(doc-full): Fix comment typo.

2009-05-18  Matthew Mundell <mmundell@intevation.de>

	* doc/Doxyfile (EXTRACT_ALL): Turn off, to enable warnings about
	missing function docs.

2009-05-13  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store.c: (store_plugin) Don't try to guess the path of the
	NVT, this resulted in wrong paths. The filename is enough for the error
	message built by safe_copy. (safe_copy) Display a more descriptive error
	message. Clarified documentation, made variable name more fitting.

2009-05-05  Jan Wagner <waja@cyconet.org>

	* packaging/debian/copyright, packaging/debian/changelog: Added some
	copyright notices and bumped version number

2009-04-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/openvas_server.c (openvas_server_sendf): Fixed forgotten name change.

2009-04-17  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/patches/: Removed. It contained a single patch which
	has already been incorporated into the trunk.

2009-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c: Removed any code path for conditional
	NESSUS_CNX_LOCK. This was a "Quick & dirty patch to run Nessus
	from behind a picky firewall (e.g. FW/1 and his 'Rule 0'): Nessus
	will never open more than 1 connection at a time."
	It appears to be deseperately outdated and never used.
	OpenVAS allows to configure the number of concurrent checks,
	so this should be the way to go in case of firewall-based problems.

2009-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/openvas_server.h, libopenvas/openvas_server.c
	(openvas_server_connect_to_server): Renamed to openvas_server_open.
	(openvas_server_close_server_connection): Renamed to openvas_server_close.
	(openvas_server_send_to_server): Renamed to openvas_server_send.
	(openvas_server_sendf_to_server): Renamed to openvas_server_sendf.

2009-04-15  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/openvas_server.c: Made function names more intuitive,
	removed superfluous newlines from log messages, added a little
	documentation.

	* libopenvas/openvas_server.h: Made function names more intuitive,
	removed superfluous include.

2009-04-14  Michael Wiegand <michael.wiegand@intevation.de>

	Added a new library for GnuTLS based communication, based on work done
	by Matthew Mundell for the openvas-manager module.

	* libopenvas/openvas_server.c: New. Contains an initial set of function
	for GnuTLS based communication.

	* libopenvas/openvas_server.h: New. Header file for the new
	functionality.

	* libopenvas/Makefile: Updated.

	* Makefile: Updated.

	* MANIFEST: Updated.

2009-04-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c (mark_post): Fixed a probably unintended
	change in r2958 by Felix.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Corrected search path for signature files when comparing their
	timestamps in store module.
	Declared two parameter of store_load_plugin as const.

	* libopenvas/store.c, libopenvas/store.h (store_load_plugin): Made
	parameters const, corrected search path for .asc (signature) files. Was
	cache dir, now is same dir as plugin.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Corrected checks when loading plugins from cache, extended
	documentation, removed debug printf.

	* libopenvas/store.c (store_load_plugin): Corrected checks and doc.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	More reformatting and documentation work in store module.

	* libopenvas/store.c: Reformatting, doc.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Reformatting and documentation work in store module.

	* libopenvas/store.c: Reformatting, doc.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Disabled checking for non-printable chars when posting security
	messages. This allows localizations and support for e.g. german or
	french characters in the messages text.
	It is unclear why this behaviour was wished (in order to prevent NTP
	corruption?).

	* libopenvas/plugutils.c (proto_post_wrapped): Disabled replacement
	of non-printable characters by spaces.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c: Reformatting, whitespace-removal, K&R style
	replacements, doc.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Phony target doc-dev is actually called doc-full.

2009-03-27  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/Makefile, libopenvas_hg/Makefile: Adjusted libtool calls to
	remove warnings about deprecated libtool usage during compile.

2009-03-06  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* doc/Doxyfile, doc/Doxyfile_full: Set PROJECT_NUMBER to 2.0.3.SVN.

	* VERSION: Set to 2.0.3.SVN.

2009-03-06  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.2 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.2.

2009-03-04  Vlatko Kosturjak <kost@linux.hr>

	* libopenvas/bpf_share.c: by default, put pcap device in non
	blocking mode - fixing plugins hang/freeze, fixes #901

2009-02-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h:
	Updated to version used in client:
	Updated ssh_login struct to carry password as well, cosmetics and
	memleak- fix (done in openvas-client rev 2597 & 2599).

2009-02-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvs/www_funcs.c (build_encode_URL): Fixed
	string length calculation. Thanks to
	Michael Meyer who spotted this and sent this patch!

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control: Fixed minor typo.

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/Makefile: Forward ported fix for broken linking.

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: New upstream release.

	* packaging/debian/control: Updated the control file to take account
        of translation work as part of the Smith review project.

	* packaging/debian/patches/00list,
	packaging/debian/patches/linker-libs.dpatch, packaging/debian/rules:
	Fixed broken linking (linker-libs.dpatch).

2009-02-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/openvas_ssh_login.c (openvas_ssh_login_file_write):
	Close file descriptor in case of error.

2009-02-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/Doxyfile_full: Makes the resulting documentation even
	more comprehensive. Switch off Latex output.

	* Makefile: make src doc latex creation conditional to presence
	of respective directories.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Last minute fixes for the openvas-libraries 2.0.1 release.

	* MANIFEST: Updated.

	* Makefile: Fixed targets "clean" and "distclean" to correctly remove
	generated HTML documentation.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.1 release.

	* VERSION: Set to 2.0.1.

	* CHANGES: Updated.

	* include/libopenvas.h: Added Doxygen directives to include README and
	COPYING files into HTML documentation.

	* ChangeLog: Cleanup.

	* libopenvas/COPYING: Moved to COPYING, a more obvious location.

	* doc/Doxyfile, doc/Doxyfile_full: Updated version, set EXAMPLE_PATH.

	* README: Added.

2009-02-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Minor cosmetics, improved documentation.

	* libopenvas/kb.h: Documentation & formatting of kb_item struct.

	* libopenvas/services1.c: Added file flag for doc block, removed
	whitespaces.

	* libopenvas/resolve.c (host2ip) : Documented return code.

	* libopenvas/system.c (emalloc): Converted doc block.

	* libopenvas/network.c: Converted documentation blocks.

	* libopenvas/rand.c: Added file flag for doc block.

	* libopenvas/store.c: Removed structuring comments, function safe_copy
	documented.

2009-02-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Copied GPL Header from host_gatherer.c over to host_gatherer.h,
	cosmetics and doc.

	* libopenvas_hg/host_gatherer.c: Documentation, K&R function decl.
	replaced.

	* libopenvas_hg/host_gatherer.h: Copied GPL header from modules
	implementation file, doc strings converted.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/hash_table_file.c: Documentation improved, newlines.

2009-02-05  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/ids_send.c (which_ttl): Added RATS ignore and a comment
	explaining the rationale.

2009-02-05  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/system.c (erealloc): Removed misleading comment; the
	function is indeed defined in libopenvas/system.h and is used in a
	number of places in openvas-libraries.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics and documentation in kb module.

	* libopenvas/kb.c: Added empty lines in comment blocks to improve
	readability (thanks matt), added briefs to comment blocks, removed
	/* within a comment block to avoid compiler warning (thanks michael),
	donated return types own line.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/config.h.in: Removed define of "DEFAULT_PORT"
	which is not used anywhere (it defaulted to ancient 3001).
	Removed define of "CLIENT_TIMEOUT". It is not used anywhere.
	Removed define of "SERVER_TIMEOUT". It is not used anywhere.
	Removed define of "LOGMORE". It is not used anywhere.
	Removed define of "NESSUSD_KEYFILE", "NESSUSD_USRKEYS",
	"NESSUSD_KEYLENGTH" and "NESSUSD_MAXPWDFAIL".  These are
	not used anywhere.
	Removed define of "PLUGIN_TIMEOUT". It is not used in
	this module.
	Removed define of "LOG_WHOLE_ATTACK". It is not used in
	this module.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed any code path that is conditional to "ENABLE_RHLST".
	It was never used, especially because it would require a file
	"rhlst.h" which isn't present at all.

	* libopenvas/hlst.h: Removed any code path that
	is conditional to "ENABLE_RHLST".

	* libopenvas/hlst.c: Removed any code path that
	is conditional to "ENABLE_RHLST".

	* include/config.h.in: Removed undef for ENABLE_RHLST.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some cleanups. Basically removing never-used code.

	* libopenvas/plugutils.c (is_shell_command_present): Removed.
	It is not used anywhere except in
	openvas-plugins/plugins/nmap_wrapper/nmap_wrapper.c for
	very ancient NASL level.

	* libopenvas/plugutils.h: Removed proto accordingly.

	* libopenvas/popen.c (nessus_popen4): Removed unused
	code that is deaactivcated with "#if 0".
	(append_argv, destroy_argv): marked as to be deleted
	eventually.

	* libopenvas/network.c (nessus_print_SSL_certificate,
	nessus_print_peer_SSL_certificate): Removed. It is unused
	code that was deactivcated with "#if 0".
	(nsend): Removed unused code that was deactivated with
	"#if 0".

2009-01-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): When creating a
	cache file for a plugin, now take care a subdirectory
	is created in the cachefolder - in case the plugin
	is located in a subfolder of the plugin folder accordingly.

2009-01-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): Fixed a bug: In
	case of using cache_folder, the wrong filenames for the
	actual plugin file where written into the cache file.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_init): Also handle NULL
	for its parameter.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_dir, store_init): Improved
	comments and made implementation more robust.
	store_init will not anymore try to create the directory.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Changed API (new parameter in openvas_ssh_login_file_read). Fixes build
	of latest openvas-server.

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h:
	Changed file headers to indicate that they are part of
	openvas-libraries.

	* libopenvas/openvas_ssh_login.c (openvas_ssh_login_file_read): Added
	parameter check_keyfiles to allow exclusion/inclusion of logins that
	are lacking pub/private key files, included parameter in documentation.

	* libopenvas/openvas_ssh_login.h: Adjusted proto for
	openvas_ssh_login_file_read.

2009-01-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.h: Applied gcc deprecation marker
	for deprecated functions.

2009-01-20  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/Makefile: Fixed typo in LO_OBJS which caused the build to
	fail on amd64.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added make targets for openvas_ssh_login module.

	* libopenvas/Makefile: Included openvas_ssh_login module.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Inclusion of openvas_ssh_login module (copy from client).

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h: Added.

	* MANIFEST, Makefile, libopenvas/Makefile: Updated.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Inclusion of hash_table_file module (copy from client).

	* libopenvas/hash_table_file.c, libopenvas/hash_table.h: Added.

	* MANIFEST, Makefile, libopenvas/Makefile: Updated.

2009-01-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* ChangeLog: Clarified last ChangeLog entry (choice of GPL header).

	* libopenvas_hg/hg_utils.c: Replaced K&R function declarations,
	documentation.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added GPL header from host_gatherer.c to other constituent files of
	the host_gatherer library (referenced as "HostLoop2 library" in
	hg_add_host.c).

	* libopenvas_hg/hg_debug.c, libopenvas_hg/hg_filter.h,
	libopenvas_hg/test.c, libopenvas_hg/hg_utils.h,
	libopenvas_hg/hg_subnet.h, libopenvas_hg/hg_dns_axfr.h,
	libopenvas/hg_add_hosts.h : Added GPL header.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas_hg/hg_filter.c: Replaced K&R function headers, transformed
	comments to javadoc style, removed some whitespaces.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas_hg/hg_add_hosts.c (hg_add_comma_delimited_hosts):
	Reformatted.

2009-01-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_load_plugin): Fixed memory leaks.

2009-01-04  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Name change for cached ("description") files for NVTs.
	They used to have the suffix ".desc" instead of ".nasl"
	but they now have the very same name as the corresponding NVT
	plus additional suffix ".desc", e.g. "x.nasl" will be "x.nasl.desc".
	This also prevents that e.g. "x.nasl" and "x.nes" (or "x.oval")
	will overwrite each others' cache.

	It is recommendable to clean the .desc directory to
	avoid unnecessary old cache files.

	* libopenvas/store.c (store_plugin): Added doc string and
	now uses g_build_filename to assemble filenames instead
	of doing this on our own. Append ".desc" rather than replace
	a present suffix.
	(store_load_plugin): Updated doc string and now uses
	g_build_filename to assemble filenames instead
	of doing this on our own. Append ".desc" rather than replace
	a present suffix.
	Set the full path as cachefile.
	(store_get_plugin_f): Aggregated params "dir" and "file"
	into "desc_file". Thus removed code to assemble name on
	our own.
	(store_get_plugin): Adapted call of store_get_plugin_f
	accordingly, assuming the given desc_file is the full path
	to the cache file.

2009-01-03  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): change return value to
	void, because the function never returns something else than
	NULL. Also any use of the method does not consider a return value
	at all. Thus cleaning up this method.

	* libopenvas/store.h: Updated proto of store_plugin accordingly.

2009-01-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing the handling of separate user-specific cache dir.
	This code are remains of the unsecure feature of plugin
	upload. Apart from this, the OpenVAS Server should eventually
	not be responsible anymore for user-specific data storage.

	* libopenvas/store.c (usr_store_dir, sys_store_dir, current_mode):
	Removed these static variables as they are not needed anymore.
	(store_dir): New. Static variable to hold the cache dir.
	(MODE_SYS, MODE_USR): Removed these macros as they are not needed any
	more.
	(store_init, store_init_sys): Use store_dir instead of sys_store_dir.
	(store_init_user): Removed functionality and marked as deprecated.
	Now it simply calls store_init_sys().
	(store_get_plugin): Reduced functionality to direct call of
	store_get_plugin_f(), because distinction between user and sys
	not necessary anymore.
	(store_plugin): Removed distinction between sys and user.

2009-01-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Further patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/store.c (store_init_sys): Marked as deprecated.
	(store_init): New. Simply sets the "sys_store_dir" without appending
	".desc".
	(store_get_plugin): Renamed param "name" to "desc_file".

	* libopenvas/store.h: Added proto for store_init.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	Added missing includes to enable compilation on Darwin and NetBSD,
	based on suggestions by Adrian Portelli.  This solves parts of bug
	#860 (http://bugs.openvas.org/860) and bug #862
	(http://bugs.openvas.org/862).

	* libopenvas/pcap.c: Added missing include for netinet/in.h.

	* libopenvas/plugutils.c: Changed to use sys/wait.h instead of wait.h.

	* libopenvas/bpf_share.h: Added missing include for sys/types.h.

	* libopenvas/popen.c: Added missing include for sys/resource.h.

2009-01-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/kb.c: Documentation.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	* configure: Regenerated to completely remove --enable-debug-store.

2009-01-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	More patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/store.c: Replaced any call of plug_get_fname
	by plug_get_cachefile.
	(store_load_plugin): Replaced call of plug_set_fname by
	plug_set_cachefile.

	* libopenvas/plugutils.c (plug_get_fname, plug_set_fname): Removed.

2008-12-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As Result of CR #20, added two doxygen configuration files and targets
	to generated source documentation.

	* doc/Doxyfile: Added. Basic configuration file.

	* doc/Doxyfile_full: Added. Enables graph generation.

	* Makefile: Targets 'doc' and 'doc_full' added, 'clean' altered, such
	that it will remove generated documentation found in doc/generated.

2008-12-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, include/config.h.in: Removed any remains
	of DEBUG_STORE as it is not used anywhere in the code.
	This also removed the configure option "--enable-debug-store".

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c: Removed OLD_CVE_SZ, OLD_BID_SZ and
	OLD_XREF_SZ and their use because this is only meant
	to support rather old version of Nessus.
	The removed code was conditionally for DEBUG_STORE anyway.

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing unused code.

	* libopenvas/store.c (store_fetch_dependencies, store_fetch_timeout,
	store_fetch_name):
	Removed. This function is never called since a long time.

	* libopenvas/store_internal.h: Removed proto for
	store_fetch_dependencies, store_fetch_name and store_fetch_timeout.

	* libopenvas/plugutils.c (plug_get_deps, plug_get_timeout,
	plug_get_name):
	Removed code that is never executed.

	TODO: Added note on the broken concept of plugutils/store
	calling each other.

2008-12-30  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/kb.h: Comments.

	* libopenvas/kb.c: Transformed comments to javadoc, slight doc
	improvements.

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Reduced the middle layer of the plugin functions that do not
	use the cache.

	* libopenvas/store.c (store_plugin): Replace call of _plug_get_id()
	by plug_get_id() and dito for several other functions (see below).

	* libopenvas/plugutils_internal.h: Removed unneeded protos.

	* libopenvas/plugutils.c (plug_get_id): Moved contents of
	_plug_get_id here.
	(_plug_get_id): Removed.
	(plug_get_oid): Moved contents of _plug_get_oid here.
	(_plug_get_oid): Removed.
	(plug_get_required_keys): Moved contents of _plug_get_required_keys here.
	(_plug_get_required_keys): Removed.
	(plug_get_excluded_keys): Moved contents of _plug_get_excluded_keys here.
	(_plug_get_excluded_keys): Removed.
	(plug_get_required_ports): Moved contents of _plug_get_required_ports here.
	(_plug_get_required_ports): Removed.
	(plug_get_required_udp_ports): Moved contents of
	_plug_get_required_udp_ports here.
	(_plug_get_required_udp_ports): Removed.
	(plug_get_deps): Moved contents of _plug_get_deps here.
	(_plug_get_deps): Removed.
	(plug_get_timeout): Moved contents of _plug_get_timeout here.
	(_plug_get_timeout): Removed.
	(plug_get_name): Moved contents of _plug_get_name here.
	(_plug_get_name): Removed.
	(plug_get_fname): Moved contents of _plug_get_fname here.
	(_plug_get_fname): Removed.
	(plug_get_category): Moved contents of _plug_get_category here.
	(_plug_get_category): Removed.

	* libopenvas/kb.h: Added a note on NEW_KB_MGMT.

2008-12-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/plugutils.c (plug_set_cachefile): New. Sets the "CACHEFILE".
	(plug_get_cachefile): News. Retrieves the "CACHEFILE".

	* libopenvas/plugutils.h: Added protos for plug_set_cachefile
	and plug_get_cachefile.

2008-12-20  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas_hg/Makefile, libopenvas/Makefile,
	openvas-libraries.tmpl.in: Honour LDFLAGS.

2008-12-19  Michael Wiegand <michael.wiegand@intevation.de>

	* configure: Regenerated to include fix for Mac OS X.

2008-12-19  Tim Brown <timb@nth-dimension.org.uk>

	* configure.in: Improved #761, should now work on Mac OS X where
	__dn_expand does not exist.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.1.SVN.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.0 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.

2008-12-16  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils_internal.h: Added declaration of _plug_get_tag.

2008-12-16  Michael Wiegand <michael.wiegand@intevation.de>

	Updated build environment to use an up-to-date libtool version.

	* config.guess, config.sub, ltmain.sh: Regenerated.

2008-12-10  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/proctitle.c (setproctitle): Reverted one instance of
	strncpy usage back to strcpy since it causes issue on server startup
	under certain circumstances.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.rc2.SVN.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0-rc1 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.rc1.

2008-12-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c : Changed comment style, added param
	documentation for plug_set_sign_key_ids.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Checking for potential code quality issues ahead of the 2.0-rc1
	release, setting ignore flags for false positives and using more
	secure functions for certain string manipulations.

	* libopenvas_hg/test.c (main): Don't warn against getopt usage, it is
	not critical here since this application is only intended for
	demonstration purposes.

	* libopenvas/pcap.c (get_random_bytes): Ignore warning, this random
	seed is random enough for our purposes.

	* libopenvas/plugutils.c: (plug_set_cve_id, plug_set_bugtraq_id,
	plug_set_xref, plug_set_tag, proto_post_wrapped) Ignore warnings
	regarding strcat since the memory is allocated correctly before
	calling strcat. (host_add_port_proto, kb_get_port_state_proto,
	mark_successful_plugin, mark_post, add_plugin_preference,
	proto_post_wrapped, scanner_add_port, plug_set_port_transport,
	plug_get_port_transport, plug_set_ssl_item, find_in_path) Ignore
	warnings regarding snprintf since libc4 (where snprintf is a security
	issue) is most certainly not present on system able to compile and run
	openvas-libraries. (plug_get_key, plug_get_host_open_port) Ignore
	warnings about lrand48 being not random enough; it is random enough
	for the usage here. (find_in_path) Removed obsolete code, change
	sprintf usage to snprintf.

	* libopenvas/network.c: (get_encaps_name, get_encaps_through,
	open_sock_tcp, auth_printf) Ignore (v)snprintf warnings; see above.
	(_socket_get_next_source_addr) Ignore warning about lrand48; see
	above.

	* libopenvas/network.h: Ignore false positive in function declaration.

	* libopenvas/proctitle.c: (initsetproctitle) Changed ignore flag to
	RATS so both flawfinder and RATS honor it. (setproctitle) Ignore
	snprintf warnings (see above), change strcpy usage to strncpy.

	* libopenvas/www_funcs.c: (build_encode_URL) Change strcpy usage to
	strncpy, change sprintf usage to snprintf, ignore snprintf warnings
	(see above), ignore lrand48 warnings (see above).

	* libopenvas/rand.c (nessus_init_random, lrand48, srand48): Ignore
	warnings about insufficient randomness.

	* libopenvas/ftp_funcs.c (ftp_log_in): Changed remaining sprintf usage
	to snprintf, ignore snprintf warnings (see above).

	* libopenvas/store.c: (arglist2str, store_load_plugin, store_plugin,
	store_get_plugin_f) Change strcat usage to strncat; ignore RATS
	warnings regarding strncat since sufficient memory is allocate before
	strncat usage. (safe_copy, store_plugin) Change ignore flag to RATS.
	(store_init_sys, store_init_user, store_get_plugin_f,
	store_load_plugin, store_plugin) Ignore snprintf warnings (see above).

2008-12-03  Michael Wiegand <michael.wiegand@intevation.de>

	Implementing CR #22 (New script_tag Command,
	http://www.openvas.org/openvas-cr-22.html).

	* libopenvas/plugutils.c: Added plug_set_tag, plug_get_tag and
	_plug_get_tag functions.

	* libopenvas/store_internal.h: Added tag field to struct, incremented
	magic number, updated function declarations.

	* libopenvas/plugutils.h: Updated function declarations.

	* libopenvas/store.c: Added store_fetch_tag function. (store_plugin)
	Added support for script_tag.

2008-11-18  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated.

2008-11-18  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/share_fd.c: Re-added missing include that resulted in
	recv_fd failing due to missing defines.

2008-11-18  Michael Wiegand <michael.wiegand@intevation.de>

	Fixing version requirements for glib as pointed out by atomicturtle.

	* configure.in: Updated glib requirements to >= 2.6.0

	* configure: Regenerated.

2008-11-17  Matthew Mundell <matt@mundell.ukfsn.org>

	* libopenvas/network.c (ovas_get_tlssession_from_connection): Return
	address instead of value, to match return type.
	(open_SSL_connection): Check errno for EINTR and EAGAIN after
	gnutls_handshake.
	(ovas_server_context_attach): Retry gnutls_handshake if necessary.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta3.SVN.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the 2.0-beta2 release.

	* VERSION: Set to 2.0.0.beta2.

	* MANIFEST: Updated.

	* CHANGES: Updated.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-libraries.tmpl.in: Added datarootdir to remove configure
	warning and to be compatible with autoconf 2.60 (see
	http://www.gnu.org/software/libtool/manual/autoconf/Changed-Directory-Variables.html).

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros.

	* libopenvas/arglists.c (arg_dump): Minor reformattings, added cast to
	avoid fprintf format string warning.

2008-11-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Narrowed down space for fingerprints in servers cache.

	Attention: Server cache has to be rebuilt!
	(remove  .desc in plugin directory)

	* libopenvas/store_internal.h : Decreased fingerprint array size.

	* ChangeLog : Email typo fixed.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros to improve 64-bit cleanliness.

	* configure.in: Added check for the glib2 library.

	* configure: Regenerated.

	* aclocal.m4: Regenerated.

	* libopenvas/harglists.c, libopenvas/arglists.c,
	libopenvas/plugutils.c, libopenvas/network.c,
	libopenvas/Makefile, libopenvas/store.c,
	libopenvas/scanners_utils.c, libopenvas/kb.c,
	openvas-libraries.tmpl.in: Introduced glib library.

	* libopenvas/harglists.c, libopenvas/harglists.h,
	libopenvas/arglists.c, libopenvas/plugutils.c,
	libopenvas/network.c, libopenvas/scanners_utils.c,
	libopenvas/kb.c, libopenvas/store.c: 32/64-bit cleanup.

	* libopenvas/plugutils.c: Minor reformatings.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Added AC_PREREQ directive to tell autoconf to generate
	a 2.50-style configure script.

2008-11-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c (ovas_get_connection_data): Renamed to
	ovas_get_tlssession_from_connection and made it return the
	tls session directly instead of connection data.
	This way it is avoided to expose the internal data
	structure "nessus_connection". It remains internal now.

	* libopenvas/network.h: Updated proto accordingly and added
	include for now-necessary gnutls.h.

2008-11-11  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store.c (store_load_plugin): Fixed usage of legacy ID
	scheme that resulted in an incorrect OID being transmitted to the client
	when processing NVTs without any legacy ID.

2008-11-10  Michael Wiegand <michael.wiegand@intevation.de>

	Removed local copies of getopt; the functionality provided by getopt has
	been replaced with glib as explained in Change Request #9
	(http://www.openvas.org/openvas-cr-9.html).

	* include/config.h.in: Removed obsolete defines for getopt.

	* configure.in: Removed obsolete checks for getopt.

	* configure: Regenerated.

	* libopenvas/getopt.c, libopenvas/getopt.h, libopenvas/getopt1.c:
	Removed obsolete local copies of getopt.

	* libopenvas/Makefile: Removed handling of getopt files.

	* TODO: Removed section regarding getopt copies.

	* MANIFEST: Updated.

	* Makefile: Removed handling of getopt files.

2008-11-07  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/network.c, libopenvas/network.h: Added
	ovas_get_connection_data function provided by Matthew Mundell as
	support for the upcoming OpenVAS Management functionality.

2008-11-06  Michael Wiegand <michael.wiegand@intevation.de>

	* INSTALL_README: Updated note regarding gnutls version requirements as
	pointed out by Toan Nguyen.

2008-11-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Work on Change Request #17 (http://www.openvas.org/openvas-cr-17.html -
	"OTP: Make NVT signatures available to OpenVAS-Client").
	Replaced sending of dummy certificate key oids by "real" fingerprints.

	* libopenvas/store.c (store_load_plugin): Fixed tests about signature
	file, replaced obsolete ID check by OID check, removed dummy string.

2008-10-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Steps to an implementation of Change Request #17
	(http://www.openvas.org/openvas-cr-17.html - "Make NVT signatures
	available to OpenVAS-Client").
	Adds the new field "sign_key_ids" to plugin-structures and the .desc
	store. Until soon, just a dummy- string will be saved and eventually
	transmitted by the server.

	IMPORTANT: Breaks compatibility and renders old server .desc- cache
	files useless.

	* libopenvas/plugutils.c (plug_set_sign_key_ids, plug_get_sign_key_ids):
	Added getter & setter to retrieve key-ids of certificates of a plugin.

	* libopenvas/plugutils.h: Prototypes for plug_set_sign_key_ids and
	plug_get_sign_key_ids added.

	* libopenvas/store_internal.h: Added sign_key_ids field to plugin struct
	 and increased magic number for server-side cache (.desc files)

	* libopenvas/store.c (store_init_sys, store_init_user): Added comments.

	* libopenvas/store.c (store_load_plugin): Check if signature file
	is new than cache (functionality will be moved), set sign_key_ids
	according to cache, added comments.

	* libopenvas/store.c (store_plugin): Stores the (dummy) key_id- string.

2008-10-12  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated.

	* packaging/debian/copyright: Updated.

	* packaging/debian/rules: Cleaned up.

	* packaging/debian/libopenvas2-dev.dirs,
	packaging/debian/libopenvas2-dev.install,
	packaging/debian/libopenvas2.dirs,
	packaging/debian/libopenvas2.install: Added.

2008-10-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/pcap.c: Added missing include for config.h; this fixes a
	bug caused by a missing #define that led to a segfault on 64bit
	machines and was discovered by Michael Meyer.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: Removed elements "scan_ids",
	"dns" and "pubkey_auth" from struct ntp_caps.

	* libopenvas/scanners_utils.c (comm_send_status): Removed
	unneeded variable declaration.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: Removed elements "md5_caching",
	"ntp_11", "plugins_oid", and "plugins_version" from
	struct ntp_caps.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/scanners_utils.c(comm_send_status): Removed
	conditional for ntp_11, because this is standard for otp.

	* libopenvas/plugutils.c (scanner_add_port): Removed
	conditional for ntp_11, because this is standard for otp.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta2.SVN.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Last minute fix to MANIFEST for 2.0-beta1.

	* MANIFEST: Updated.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 2.0-beta1 release.

	* VERSION: Set to 2.0.0.beta1.

	* CHANGES: Updated.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Fixed uses of sprintf in libopenvas/plugutils.c that could lead to
	buffer overflows under certain circumstances. Told RATS and flawfinder
	to ignore the use of snprintf; we will assume that glibc provides us
	with an up-to-date snprintf. Changed "flawfinder" ignore statements to
	"RATS" since the "RATS" keyword is supported by both RATS and
	flawfinder.

	* libopenvas/plugutils.c (plug_set_id, _add_plugin_preference,
	plug_set_replace_key): Replaced sprintf usage with snprintf.

2008-09-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c (proto_post_wrapped): escape_crlf is
	now standard with OTP 1.0.
	Removed unused variables caps and t.

	* libopenvas/ntp.h: Removed elements "plugins_xrefs",
	"plugins_bugtraq_id", "md5_by_name", "fast_login",
	"dependencies", "plugins_cve_id", "ciphered", "escape_crlf"
	and "timestamps" from struct ntp_caps.
	Removed defines for NTP_10, NTP_11 and NTP_12.

2008-09-19  Michael Wiegand <michael.wiegand@intevation.de>

	Added support for new LOG and DEBUG messages.

	* libopenvas/plugutils.c (proto_post_log, post_log, post_log_udp,
	proto_post_debug, post_debug, post_debug_udp): Added functions to
	support new LOG and DEBUG messages.

	* libopenvas/plugutils.h: Added function declarations for new functions.

2008-09-16  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (plug_get_oid): Do not use cached OIDs, use
	_plug_get_oid instead of store_fetch_oid; otherwise plug_get_oid will
	return wrong OIDs under certain circumstances, which breaks qsort among
	others.

2008-09-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (mark_successful_plugin, mark_post): Use OIDs
	instead of IDs for logging messages and plugin success in KB.

2008-09-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (proto_post_wrapped): Use OIDs instead of IDs,
	removed obsolete code.

2008-09-02  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/network.c (ovas_server_context_attach): Display gnutls
	error messages only when DEBUG_SSL is defined.

2008-08-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.h: Added an explicit include.

2008-08-21   Vlatko Kosturjak <kost@linux.hr>

	* libopenvas/plugutils.c (plug_set_id): Display "Legacy detected plugin"
	only if DEBUG is defined

2008-07-31  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/plugutils.c: Fixed duplicate declaration of oldid.

	* libopenvas/ntp.h: Added definition for ONTP/1.3.

2008-07-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/pcap.c (getinterfaces): Added a FIXME reminder about
	bad programming style with potential of runtime failires as
	reported by Hanno Böck in order to not forget about this problem.

2008-07-18  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/plugutils.c, libopenvas/plugutils.h: Added additional
	checks to plug_set_id and plug_set_oid functions, so that setting
	an OID can not override an a legacy ID. Moreover, setting a legacy
	ID implictly sets a legacy OID.

2008-07-08  Tim Brown <timb@nth-dimension.org.uk>

	* ChangeLog, openvas-libraries/libopenvas/store_internal.h,
	packaging/debian/changelog: Fix typos.

2008-07-07  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog: Set
	openvas-distro-deb@wald.intevation.org as Debian Maintainer.

	* packaging/debian/changelog, packaging/debian/copyright,
	packaging/debian/rules: Remove trailing witespaces at EOL and EOF.

	* packaging/debian/changelog, packaging/debian/control:
	Move Section to right place for openvas-libraries in control.

	* packaging/debian/changelog, packaging/debian/control:
	Also depend on libgnutls-dev, libpcap-dev for -dev.

	* packaging/debian/changelog, packaging/debian/libopenvas1.dirs,
	packaging/debian/libopenvas1-dev.dirs: Remove debian/*.dirs since
	unneeded.

2008-07-04  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog, packaging/debian/control:
	New debian package version with some minor changes.
	Set openvas-distro-debian@wald.intevation.org as Debian Maintainer.

2008-07-04  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas_hg/hg_dns_axfr.c (hg_dns_axfr_add_host)
	(hg_dns_read_ns_from_answer, hg_dns_axfr_query): Replaced ns_get16
	with local copies taken from glibc as ns_get16 proved to be not very
	portable either and led to problems in the build process for RPMs.

2008-06-30  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 1.0.3.SVN.

2008-06-30  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 1.0.2 release.

	* VERSION: Set to 1.0.2.

	* CHANGES: Updated.

2008-06-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas-config.in: Fix variable replacement problems.
	Original problem report and initial patch supplied by
	Ales Nosek.

2008-06-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Simplify handling of libopenvas-config: The two-step
	method is not necessary.

	* libopenvas-config.pre.in: Removed. Renamed to
	libopenvas-config.in.

	* libopenvas-config.in: New. Former libopenvas-config.pre.in.

	* configure.in: Process libopenvas-config.in instead of
	libopenvas-config.pre.in.

	* Makefile: Removed any processing of libopenvas-config.

	* configure: Updated.

	* MANIFEST: Updated.

2008-06-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing handling of "CIPHER" information because
	the client-server communication is always encrypted.

	* configure.in: Removed handling of "cipher_cflags"
	and "use_cipher". This means the option --enable-cipher
	is not available anymore.

	* libopenvas-config.pre.in: Removed handling of CIPHER and
	CIPHER_CFLAGS.

	* openvas-libraries.tmpl.in: Removed handling of
	USE_CIPHER and CIPHER_CFLAGS.

	* INSTALL_README: only slightly improved. Now does
	not mention anymore --enable-cipher option.

	* configure: Updated.

2008-06-20  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/hlst.c (sort_hlst): Avoid sorting an hlst if it has no
	entries since that will lead to an emalloc issue under certain
	conditions.

2008-06-12  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store_internal.h: Increased MAGIC number to reflect
	changes as suggested by Bernhard Herzog. Deleting
	/lib/openvas/plugins/.desc/* is no longer neccessary.

2008-06-12  Michael Wiegand <michael.wiegand@intevation.de>

	Increased the space available to plugins for preferences
	storage. This resolves an issue with plugins with a large
	number of radio button options, as they need to store the
	text for all options in the name field.

	IMPORTANT: You need to delete the server plugin cache in
	/lib/openvas/plugins/.desc/* to force the server to create
	a new cache after compiling with this change. Otherwise the
	server will send wrong plugin information to the client,
	resulting in missing options in the preferences.

	* libopenvas/store_internal.h: Increased size of name field
	in pprefs struct to allow for plugins with many preferences.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store_internal.h: Increased MAGIC number, lowered size
	of oid vom 1024 bytes to 100.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: New. Contains the definition for ntp_caps (taken
	from comm.h) and the makros for NTP protocol IDs (taken
	from ntp.h of package openvas-server)

	* libopenvas/comm.h: Removed definition of ntp_caps and cleaned up.

	* Makefile: Install ntp.h as well.

	* MANIFEST: Updated.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/nessus-devel.h: Removed. It wasn't included anywhere in OpenVAS.

	* MANIFEST: Updated.

2008-05-02  Javier Fernández-Sanguino Peña <jfs@computer.org>

	* libopenvas/Makefile, libopenvas_hg/Makefile, openvas-libraries.tmpl.in:
	Fix the build process to get the libraries to include
	their linked libraries.

	* packaging/debian/control, packaging/debian/changelog: New package
	version, fixing build-dep

2008-05-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/Makefile: Fixed all dependencies on header files. Removed
	non-existing module "ptycall".

	* libopenvas/kb.c: Fixed include method.

	* libopenvas/store_internal.h: Added missing proto for store_fetch_oid()

2008-04-30  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/comm.h, libopenvas/plugutils.c, libopenvas/store_internal.h,
	libopenvas/plugutils.h, libopenvas/plugutils_internal.h,
	libopenvas/store.c: Preliminary support for script_oid function.

	* packaging/debian/control, packaging/debian/copyright: Minor updates to
	control and copyright file to fix issues highlighted by jfs in regard to
	the priority and copyright of the packaging respectively.

	* packaging/debian/control: Minor update to control to fix differing
	dependency between openvas-libraries and openvas-libnasl as
	highlighted by jfs.

2008-04-18  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging/fedora: New. Directory for Fedora RPM files.

	* fedora/openvas-libraries-1.0.1-1.fc8.openvas.spec,
	fedora/openvas-libraries-1.0.1-hg-Makefile.diff
	fedora/openvas-libraries-1.0.1-Makefile.diff: New.

	* MANIFEST.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging/opensuse: New. Directory for OpenSUSE RPM files.

	* packaging/opensuse/openvas-libraries-1.0.1-1.suse102.openvas.spec,
	packaging/opensuse/openvas-libraries-1.0.1-Makefile.diff,
	packaging/opensuse/openvas-libraries-1.0.1-hg-Makefile.diff: New.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c (open_socket): Fixed makro name for SSL debugging
	and thus reactived code execute for debug-ssl mode.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile, libopenvas_hg/Makefile: Add missing DESTDIR for install
	targets.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* INSTALL_README: Remove note about bison as it is not needed anymore.

2008-04-16  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor fixes, now lintian clean.

2008-04-02  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated for new upstream release

2008-04-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: post-release version bump to 1.0.2.SVN

2008-04-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 1.0.1.

	* VERSION: Set to 1.0.1.

	* CHANGES: Updated.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added item about Makefile improvements.

	* MANIFEST: Fixed.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Removed various declarations
	that do not appear anywhere else in OpenVAS.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Moved some declarations for module plugutils
	to libopenvas/plugutils.h.

	* libopenvas/plugutils.h: Added some declarations from
	include/libopenvas.h.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/services.c, libopenvas/network.c: Removed
	"ExtFunc" declarations.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Removed Windows-Specific ifdef's.

	* include/includes.h: Removed "ExtFunc".

	* TODO: Changed entry about include/includes.h

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/getopt1.c: Add inclusion of config.h
	to have openvas-libnasl compile again.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/popen.h: Fixed proto.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/kb.h, libopenvas/store.h,
	libopenvas/services1.h, libopenvas/system.h,
	libopenvas/plugutils.h, libopenvas/arglists.h,
	libopenvas/network.h, libopenvas/bpf_share.h,
	libopenvas/share_fd.h, libopenvas/pcap_openvas.h,
	libopenvas/popen.h, libopenvas/www_funcs.h:
	Changed Author and Copyright to the contents of
	include/libopenvas.h which is the origin of most
	of the contents of the new header files.

2008-03-26  Tim Brown <timb@nth-dimension.org.uk>

	* configure.in: Fix up resolv checks as dn_expand is only
	a weak alias to __dn_expand. resolv.h #define's it but
	autoconf never #includes that when making the check.

	* configure: Updated.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Fix up some includes.

	* Makefile: Don't install includes.h, no one external
	should be in need of this.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/getopt.c: Replaced inclusion of includes.h
	by config.h which appears sufficient.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/getopt.h: Moved to libopenvas/

	* libopenvas/getopt.h: New. Previous include/getopt.h.

	* libopenvas/getopt1.c: Removed includes.h and adapted
	according to move of getopt.h

	* MANIFEST: Updated.

	* Makefile: Reflected location change of getopt.h.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ids_send.c: Removed inclusion of includes.h
	and added FIX() definition from there.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/hlst.c: replace inlusion of "includes.h" by
	respective single includes.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Made openvas-libraries compile after a "make clean".

	* include/libopenvas.h: Moved various defines to
	libopenvas/ids_send.h.

	* libopenvas/ids_send.h: Added some defines moved
	from libopenvas.h.

	* libopenvas/plugutils.c: Added missing include.

	* libopenvas/network.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/ids_send.c: replace inlusion of "includes.h" by
	respective single includes except that includes.h
	remains were it is for a missing define ("FIX()").
	Removed ExtFunc.

	* libopenvas/ftp_funcs.h: Added missing include.

	* TODO: Removed resolved entry.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module store.

	* libopenvas/store.c: replace inlusion of "includes.h" by
	respective single includes. Replaced PATH_MAX by MAXPATHLEN.

	* libopenvas/store.h: New. Contains declarations
	for module "store" (extracted from libopenvas.h)

	* include/libopenvas.h: Removed declarations for store
	and replaced by include of store.h.

	* Makefile: Install libopenvas/store.h.

	* MANIFEST: Updated.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.h: Renamed to store_internal.h.

	* libopenvas/store_internal.h: New. Former store.h.

	* libopenvas/plugutils.c: Reflect renaming of store.h to
	store_internal.h.

	* libopenvas/store.c: Reflect renaming of store.h to
	store_internal.h and added missing includes.

	* MANIFEST: Updated.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module share_fd.

	* libopenvas/share_fd.c: removed inlusion of "includes.h".

	* libopenvas/share_fd.h: New. Contains declarations
	for module "share_fd" (extracted from libopenvas.h)

	* include/libopenvas.h: Removed declarations for share_fd
	and replaced by include of share_fd.

	* Makefile: Install libopenvas/share_fd.h.

	* MANIFEST: Updated.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for modules services and services1.

	* libopenvas/services.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/services1.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/services1.h: New. Contains declarations
	for module "services1" (extracted from libopenvas.h)

	* libopenvas/services.h: Moved declarations of services1 to
	services1.h.

	* include/libopenvas.h: Removed declarations for services1
	and replaced by include of services1.

	* include/popen.h: Added missing include for stdio.h.

	* Makefile: Install libopenvas/services1.h.

	* MANIFEST: Updated.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module scanners_utils.

	* libopenvas/scanners_utils.c: replace inlusion of "includes.h" by
	respective single includes. Removed ExtFunc.

	* include/libopenvas.h: Removed declarations for scanners_utils
	and replaced by include of scanners_utils.

	* include/comm.h: Added missing include for arglists.h.

	* Makefile: Install libopenvas/scanners_utils.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module rand.

	* libopenvas/rand.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Removed declarations for rand
	and replaced by include of proctitle.

	* Makefile: Install libopenvas/rand.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module proctitle.

	* libopenvas/proctitle.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Removed declarations for proctitle
	and replaced by include of proctitle. The declarations were
	not identical but similar enough.

	* Makefile: Install libopenvas/proctitle.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/scanners_utils.c (qsort_compar): Made static.

2008-03-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module popen.

	* libopenvas/popen.h: New. Contains declarations
	for module "popen" (extracted from libopenvas.h)

	* libopenvas/popen.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any popen declarations
	to popen.h.

	* libopenvas/scanner_utils.h: Added missing include.

	* Makefile: Install libopenvas/popen.h.

	* MANIFEST: Updated.

2008-03-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module www_funcs.

	* libopenvas/www_funcs.h: New. Contains declarations
	for module "www_funcs" (extracted from libopenvas.h)

	* libopenvas/www_funcs.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any www_funcs declarations
	to www_funcs.h.

	* libopenvas/plugutils.h: Added missing include.

	* Makefile: Install libopenvas/plugutils.h.

	* MANIFEST: Updated.

2008-03-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module plugutils.

	* libopenvas/plugutils.h: New. Contains declarations
	for module "plugutils" (extracted from libopenvas.h)

	* libopenvas/plugutils.c: replace inlusion of "includes.h" by
	respective single includes. Removed "ExtFunc".

	* include/libopenvas.h: Moved any plugutils declarations
	to plugutils.h.

	* libopenvas/comm.h, libopenvas/services.h,
	libopenvas/scanners_utils.h: Remove "ExtFunc" declaration.

	* Makefile: Install libopenvas/plugutils.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.h: Renamed to plugutils_internal.h.

	* libopenvas/plugutils_internal.h: New. Former plugutils.h.

	* libopenvas/store.c: Reflect renaming of plugutils.h to
	plugutils_internal.h.
	(store_get_plugin_f): Made static.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module system.

	* libopenvas/system.h: New. Contains declarations
	for module "system" (extracted from libopenvas.h)

	* libopenvas/system.c: replace inlusion of "includes.h" by
	respective single includes. Removed empty "ExtFunc".

	* include/libopenvas.h: Moved any system declarations
	to system.h.

	* Makefile: Install libopenvas/system.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.h: Renamed to system_internal.h

	* libopenvas/system_internal.h: New. Previous system.h.

	* libopenvas/harglists.c, libopenvas/pcap.c,
	libopenvas/system.c, libopenvas/arglists.c,
	libopenvas/Makefile, libopenvas/kb.c,
	MANIFEST: Reflect name change from
	system.h to system_internal.h.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module pcap.

	* libopenvas/pcap_openvas.h: New. Contains declarations
	for module "pcap_openvas" (extracted from libopenvas.h)

	* libopenvas/pcap.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any pcap declarations
	to pcap_openvas.h.

	* Makefile: Install libopenvas/pcap_openvas.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module kb.

	* libopenvas/kb.h: New. Contains declarations
	for module "kb" (extracted from libopenvas.h)

	* libopenvas/kb.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any kb declarations
	to kb.h.

	* Makefile: Install libopenvas/kb.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/harglists.h: Removed. Moved to libopenvas/harglists.h.

	* libopenvas/harglists.h: New. Former include/harglists.h.

	* Makefile: Reflect move of harglists.h.

	* libopenvas/harglists.c: replace inlusion of "includes.h"
	separate ones for the only needed declarations.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas_hg/Makefile: Added path to libopenvas/ for
	include files. This make the library to build again.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module bpf_share.

	* libopenvas/bpf_share.h: New. Contains declarations
	for module "bpf_share". (extracted from libopenvas.h and removed
	ExtFunc while we are at it)

	* libopenvas/bpf_share.c: replace inlusion of "includes.h" by
	"pcap.h" which is already sufficient.

	* include/libopenvas.h: Moved any bpf_share declarations
	to bpf_share.h.

	* Makefile: Install libopenvas/bpf_share.h.

	* MANIFEST: Updated.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Implementing OpenVAS Change Request #5: Remove BPF sharing feature

	* configure.in: Remove option "--enable-bpf-sharing" and adapt
	corresponding messages.

	* configure: updated.

	* README.BPF: Renamed Nessus to OpenVAS, added note that there
	once was a feature for bpf-sharing.

	* libopenvas/bpf_share.c: Removed the whole alternative
	block for "HAVE_DEV_BPFN".
	(main): Also removed the now useless=empty test frame.

	* libopenvas/Makefile: bpf_sharing does not need to know
	about the StateDir anymore.

	* TODO: Removed entry about BPF sharing.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added entry describing how the cleanup re header files
	should be continued.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.h: New. Contains external header information
	for module "network". (extracted from libopenvas.h)

	* libopenvas/ftp_funcs.h: Updated header for OpenVAS, removed
	"ExtFunc".

	* libopenvas/ftp_funcs.c: Updated header for OpenVASremoved "ExtFunc",
	replaced includes.h by actually required includes.

	* include/libopenvas.h: Moved any ftp_funcs declarations
	to ftp_funcs.h. Moved most network declarations to network.h.

	* Makefile: Install libopenvas/network.h and libopenvas/ftp_funcs.h.

	* libopenvas/arglists.h: Added forgotten ifdef.

	* MANIFEST: Updated.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing unsused module "data". It was meant as a future
	replacement of arglists. However, it does only try the same
	philosophy with some improvments whereas it makes more
	sense to leave optimized handling to specialists like glib.

	* libopenvas/data.c, include/data.h: Removed.

	* TODO: Removed enty about data.c.

	* MANIFEST: updated.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	A sample cleanup for header files.

	* libopenvas/arglists.h: New. Contains external header information
	for module "arglists". (extracted from libopenvas.h)

	* Makefile: Install libopenvas/arglists.h.

	* include/libopenvas.h: Converted header block to standard one.
	Removed any arglists definitions and instead includes arglists.h.

	* libopenvas/arglists.c: Replace generic include of includes.h
	by respective required single include statements.
	Removed any use of "ExtFunc" declaration which is empty anyway.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c: Removed include for diff.h.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Annotated module names, some lines reordered,
	removed W32 conditional.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added entry about data.c

2008-03-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/Makefile: Removed handling of module "diff".

	* libopenvas/diff.c, libopenvas/diff.h: Removed as the
	only method "banner_diff" isn't used anywhere in OpenVAS.

	* MANIFEST: updated.

2008-03-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing the apparently unused module "snprintf". There exists
	no corresponding proto and thus it could never be used without
	occuring warnings during compilation. snprintf is part of C99.

	* libopenvas/Makefile: Remove handling of snprintf module.

	* MANIFEST: Updated.

	* libopenvas/snprintf.c: Removed.

2008-03-03  Laban Mwangi <labeneator@gmail.com>

	* libopenvas/plugutils.c, libopenvas/proctitle.c,
	libopenvas/store.c, libopenvas/www_funcs.c:
	Adding FlawFinder ignores to various string operations
	as discussed on the Mailing List.

2008-02-16  Laban Mwangi <labeneator@gmail.com>

	* libopenvas/hlst.c (flush_hlst, make_hlst, sort_hlst, unsort_hlst),
	libopenvas/hlst.h (_hlst): Fixing flawfinder l4 warnings
	related to flawfinder thinking that a ptr in a linkedlist called
	access is = the call access(2)

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/store.c (safe_copy): Cast return value strlen to
	match format string.  Silences a compiler warning

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/www_funcs.c (http11_get_head): Removed this unused
	function.  Silences a compiler warning.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas_hg/hg_dns_axfr.c (hg_dns_axfr_add_host)
	(hg_dns_read_ns_from_answer, hg_dns_axfr_query): Use ns_get16
	instead of _getshort.  _getshort is defined in glibc but not
	declared in any headerfile.  ns_get16 is a newer API but should be
	widely available, too.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/hlst.c (copy_hlst): Fix Flawfinder issue.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/harglists.c (say_creating): Fix format string to
	match the types that will actually be used
	(say_closing, message): Fix Flawfinder issues
	(do_printf): Fix flawfinder issues.  Fix gcc warnings about
	fprintf args, adapting a format string to better match the purpose
	of printing the value of a pointer.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removal of Flawfinder issues.

	* libopenvas/system.c (emalloc): replace usleep() by nanosleep().
	(estrdup): Set two Flawfinder: ignore, one reported path can not
	happen (now documented) and whether to use strlen() is a more general
	question.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.c, libopenvas/system.h: Applied standard header,
	added comments on unclear things.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.c (emalloc, erealloc): Added type cast to get rid of
	compiler warning.

2008-02-12  Laban Mwangi <labeneator@gmail.com>

	* INSTALL_README: Added dependent libraries (bug
	fix for aid #591)

2008-02-12  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor fixes, now includes scripts to
	allow dependents to build. Also fixed minor typo in
	packaging/debian/copyright.

2008-02-05  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor changes, now builds lintian clean.
	* packaging/debian/copyright: More information in the copyright,
	including a detailed account of holders.

2007-11-07  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control, packaging/debian/copyright: Minor
	changes to fix Homepage and Copyright directives.

2007-10-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: Updated.

2007-10-31  Tim Brown <timb@nth-dimension.org.uk>

	* packaging, packaging/debian: New directories.

	* packaging/debian/control, packaging/debian/libopenvas.dirs,
	packaging/debian/compat, packaging/debian/libopenvas-dev.install,
	packaging/debian/changelog, packaging/debian/libopenvas.install,
	packaging/debian/copyright, packaging/debian/rules,
	packaging/debian/libopenvas-dev.dirs: New. The debian packaging files.

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: post-release version bump to 1.0.1.SVN

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: Updated.

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 1.0.0.

	* VERSION: Set to 1.0.0.

	* CHANGES: Updated.

2007-10-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* README.HPUX: Removed. This information seem to be a leftover
	from stoneage time.

	* TODO: More things noted.

2007-10-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some code cleanups.

	* libopenvas/plugutils(plug_get_fresh_key): Fixed wrong number of
	arguments for fprintf call.

	* libopenvas/harglists.c(harg_addt, harg_set_valuet, harg_renamet): Add
	more ()s to make clear && is to be evaluated before ||. This was
	suggested by gcc.

	* libopenvas/www_funcs.c(http_get, http_head, httpver, http10_head, http10_get,
	http10_get_head, http11_head, http11_get): Removed. These functions have never been used.

2007-10-08  Bernhard Herzog  <bh@intevation.de>

	* libopenvas_hg/Makefile: Install hosts_gatherer.h and hg_utils.h
	into ${includedir}/openvas.  They contain declarations needed by
	openvas-server and openvas-libnasl

2007-09-25 Tim Brown <timb@nth-dimension.org.uk>

	Patch to fix two "implicit declaration" gcc-warnings submitted
	by Hanno Böck on openvas-devel.

	* include/includes.h: Add include of fnmatch.h.

	* include/libopenvas.h: Added proto for kb_item_rm_all().

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: bumped to 0.9.2.SVN

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 0.9.1.

	* VERSION: Set to 0.9.1.

	* CHANGES: Updated.

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Removed the entry about separate versioning (it is
	done now). Also removed the entry about reviewing the Debian patches
	to nessus-libraries (done).

	* libopenvas/bpf_share.c, libopenvas/services.h: Fixed paths to
	state dir to LFSH standard. This make the current Debian patch
	to the according Makefile in nessus-libraries unnecessary.

2007-08-03  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, openvas-libraries.tmpl.in, include/libvers.h.in,
	libopenvas/plugutils.c: Replaced NESSUS_MAJOR etc. by
	OPENVASLIBS_MAJOR etc. as well as NL_MAJOR etc. by
	OPENVASLIBS_MAJOR etc.

	* configure: updated.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c, libopenvas/scanners_utils.c,
	libopenvas/store.c: Removed unused variables.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas_hg/Makefile: Fix dependencies for target test.

	* libopenvas_hg/hosts_gatherer.h: Add missing proto
	for hg_test_syntax().

	* libopenvas_hg/test.c (main): Fix return type.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: bumped to 0.9.1.SVN

	* CHANGES: updated.

	* libopenvas_hg/hg_dns_axfr.c: Removed CYGWIN
	part which was not implemented anyway (just a stub).

	* libopenvas/getopt1.c, libopenvas/getopt.c,
	libopenvas/harglists.c, libopenvas/hlst.c: Removed
	handling of _WIN32.

	* Makefile: Removed target win32.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libhosts_gatherer, libopenvas_hg: renamed
	libhosts_gatherer to libopenvas_hg.

	* Makefile: renamed libhosts_gatherer to libopenvas_hg.

	* MANIFEST: updated.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas-config.pre.in, libhosts_gatherer/Makefile,
	libhosts_gatherer/test.c: Renamed libhost_gatherer
	by libopenvas_hg.

2007-08-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed strange handling of CWARN which tries to collect
	a number of warning wishes for compilation. It didn't
	really work anyway.
	Replaced this by: allways give all warnings (-Wall).

	* configure.in, openvas-libraries.tmpl.in: Removed handling
	of CWARN[01234] and CWALL.

	* configure: updated.

	* libopenvas/Makefile, libhosts_gatherer/Makefile: Added
	-Wall as compile flag.

2007-07-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* CHANGES: Set release date to 27.7.2007

2007-07-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 0.9.0.

	* VERSION: Set to 0.9.0.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/proctitle.c (setproctitle):
	Change name of daemon from nessusd to openvasd.

	* include/config.h.in: Removed NESSUSD_USERNAME which is not
	used anywhere.

	* libopenvas/services.h: Changed paths from nessus to openvas.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: replaced AC_HAVE_LIBRARY by AC_CHECK_LIB for
	gnutls, resolve and pcap and emit error when not found.
	Also replaced the not-so-helpful message after running
	configure with some more useful.

	* configure: updated.

	* libopenvas/Makefile: Fixed dependencies reg. network.h.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: updated.

2007-07-25  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.h: Removed. Everything declared in network.h
	is also declared in libopenvas.h

	* libopenvas/pcap.c, libopenvas/network.c, libopenvas/ids_send.c:
	Remove includes of network.h

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (ovas_server_context_attach)
	(read_stream_connection_unbuffered)
	(write_stream_connection4, internal_send, internal_recv): Remove
	unused variables

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c: Add missing include of <gnutls/x509.h>

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (verify_peer_certificate): Make status an
	unsigned int so that it matches the signature of
	gnutls_certificate_verify_peers2

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (set_gnutls_priorities)
	(set_gnutls_protocol): Renamed set_gnutls_priorities to
	set_gnutls_protocol
	(open_SSL_connection, ovas_server_context_attach): Updated because
	of set_gnutls_priorities renaming
	(set_gnutls_priorities): New function that sets the priorities of
	a session from a bunch of int arrays and handles errors
	(set_gnutls_sslv23, set_gnutls_sslv3, set_gnutls_tlsv1): Use
	set_gnutls_priorities to set the priorities instead of calling the
	gnutls functions directly.  Also return an error code properly.

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Return a value (0) if
	already initialized

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Make sure
	gnutls_global_init is only called once even if nessus_SSL_init is
	called multiple times.

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (load_file, unload_file): Use emalloc and
	efree to be consistent with the rest of the libopenvas code

2007-07-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/services.h: Fixed location of openvas-services.

2007-07-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvas-libraries.tmpl.in: Removed remains for libcap-nessus
	and PCAP_-variables

2007-07-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	First preparations for release.

	* include/libopenvas.h, include/config.h.in: Removed last occurances of HAVE_SSL.

	* MANIFEST: updated.

	* CHANGES: New. Describes Changes for users.

	* Makefile: No sbin required for installation of this package.

	* TODO: Removed item about libpcap which indeed has been removed
	meanwhile.

	* INSTALL_README: Added a warning that these instructions might
	not be uptodate.

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* include/includes.h: Remove openssl includes

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* include/libopenvas.h: Removed the declaration of
	nessus_register_connection that uses a SSL* as the second
	parameter.  The void* variant is still there.

2007-07-17  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.h, include/libopenvas.h: Remove declarations
	of unused and unimplemented functions:
	   stream_get_server_certificate
	   stream_get_ascii_server_certificate

2007-07-17  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_install_passwd_cb, sslerror)
	(sslerror2): Removed.  They are no longer used anywhere.
	(stream_get_ssl): Change the return type to void* so that we no
	longer need openssl.h

	* include/libopenvas.h: Remove declaration of
	nessus_install_passwd_cb and sslerror.  Update declaration of
	stream_get_ssl

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (verify_peer_certificate): If the peer
	did not send a certificate, treat it as valid.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (OVAS_CONNECTION_FROM_FD): New. Macro to
	determine the nessus_connection* given a nessus file descriptor
	(nessus_register_connection, ovas_allocate_connection): Most of
	nessus_register_connection is now in the new function
	ovas_allocate_connection.
	(set_gnutls_priorities): New.  Frontend for the other set_gnutls_*
	functions.
	(verify_peer_certificate): New.  Function to verify the peer
	certificate
	(open_SSL_connection): Use set_gnutls_priorities.
	(ovas_server_context_new): New.  Function to allocate an
	ovas_server_context_t
	(ovas_server_context_free): New.  Function to free an
	ovas_server_context_t
	(ovas_server_context_attach): New.  Functin to set up SSL/TLS on a
	socket with parameters from a ovas_server_context_t

	* include/libopenvas.h: Add declarations for the new functions and
	types.  Always declare nessus_SSL_init.

2007-06-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libhosts_gatherer/hg_add_hosts.c: Backported patch from original
	nessus-libraries branch NESSUS_2_2 as committed by Renaud Deraison
	June, 25 2007. Original commit message there: "bugfix".

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_password_cb): Removed because
	it's not used anymore.

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Handle errors.

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas-config.pre.in: remove the @pcap_flag@ substitution
	from the --libs output.  The pcap options are now in EXTRA anyway
	and @pcap_flag@ is no longer substituted.

2007-06-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed local copy of pcap library.

	* configure.in, Makefile, libopenvas-config.pre.in:
	Removed any handling of libpcap-nessus

	* configure: updated with new autoconf version as of Debian etch

	* libpcap-nessus/: Removed entire directory.

2007-06-21  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_install_passwd_cb): Use correct
	function name in error message

2007-06-21  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (sslerror2, sslerror)
	(nessus_install_passwd_cb): Get rid of the last actual OpenSSL
	calls.  The implementations now simply print an error message and
	do nothing.

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (open_SSL_connection): Better error
	handling for the gnutls function calls.

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c: Keep a pointer to the gnutls credentials
	struct so that it can be freed properly:
	(struct nessus_connection): New member tls_cred
	(release_connection_fd): Free tls_cred
	(open_SSL_connection): Store the credentials in the tls_cred
	member

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (load_file, unload_file): New. Helper
	functions to load certificates and keys.
	(load_cert_and_key): New.  Loads certificate and key files into
	the gnuTLS credentials object.  This function supports decryption
	of private keys.
	(open_SSL_connection): use load_cert_and_key to load the
	certificate and key.  Remove the warnign about unsupported key
	decryption.  Load the CA files if given.

2007-06-14  Bernhard Herzog  <bh@intevation.de>

	First step in the code to move from OpenSSL to GnuTLS.  The code
	in network.c now uses GnuTLS instead of OpenSSL for stream
	connections.  There are still a few remnants of the OpenSSL code,
	though and code using the library will still need to link -lssl.

	* libopenvas/network.c (struct nessus_connection)
	(release_connection_fd, nessus_register_connection, sslerror)
	(nessus_SSL_init, open_SSL_connection, open_stream_connection)
	(open_stream_connection_unknown_encaps5)
	(read_stream_connection_unbuffered, write_stream_connection4)
	(stream_pending): Use GnuTLS instead of OpenSSL.
	(stream_get_ssl): Now always returns NULL since there's no SSL*
	associated with a stream anymore.  See the comments in the code
	for some of the implications of this.
	(tlserror, set_gnutls_sslv23, set_gnutls_sslv3, set_gnutls_tlsv1):
	New functions for the GnuTLS support.

2007-06-04  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (struct nessus_connection)
	(open_SSL_connection, write_stream_connection4): Remove
	nessus_connection member last_ssl_err because it's only assigned
	to, but never used.

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: Renamed from CVS to SVN.

	* TODO: Some more open questions.

	* include/includes.h: Removed a nessus header file.

2007-05-23  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (data_left): Removed.  The function was
	commented out and never used.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c: Renamed all closesocket() to close().
	closesocket() was a remain from trying to be NT compatible.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure: updated.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Fixed dependencies for target install. This
	way now also libopenvas-config gets created during install
	from libopenvas-config.tmpl which wasn't the case before.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Fixed name for libopenvas-config man page for installation.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: installation target for headerfiles renamed from
	nessus to openvas.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Introduce "make dist" to create a tar-ball.

	* VERSION: Set to .CVS.

	* MANIFEST: New. List of source files for dist.

	* Makefile: New target "dist".

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus-config.pre.in: Removed.

	* libopenvas-config.pre.in: New. Replaces nessus-config.pre.in.

	* nessus-config.1: Removed.

	* libopenvas-config.1: New. Replaces nessus-config.1.

	* configure.in, Makefile: Replace nessus-config by libopenvas-config.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus-config.pre.in, Makefile: Removed DESTDIR. It looks
	pretty useless as it needs to be set in the shell.
	It was introduced in Nessus 1.3.1.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c: Removed any conditional alternatives
	for HAVE_SSL (ssl is mandatory now)

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	First, intermediate step of migrating from OpenSSL to GNUTLS:
	Remove the all old stuff at the configure-level.

	* configure.in: Removed any  handling of OpenSSL and the
	conditional handling of SSL support. Inserterted mandatory
	requirement of GNUTLS.

	* configure: Updated.

	* openvas-libraries.tmpl.in, nessus-config.pre.in: Removed
	any OpenSSL handling.

2007-04-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Removed cygwin stuff.

2007-04-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, Makefile, INSTALL_README: Removed handling of "uninstall-nessus".

	* uninstall-nessus.in: Removed.

2007-04-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing various Windows related files.

	* README.WINDOWS, nmake.w32, nmake.bat, nessus.def,
	include/config.w32, include/ntcompat.h: Removed.

	* include/includes.h: Removed some W32-specific elements.

2007-03-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile, libopenvas/Makefile: Renaming libnessus to libopenvas.
	Fixing header from GPL to LGPL.

	* libopenvas/store.c, libopenvas/plugutils.c, libopenvas/ids_send.c,
	libopenvas/arglists.c, libopenvas/data.c, libopenvas/network.c,
	libopenvas/services.c, uninstall-nessus.in, include/includes.h:
	Added header. Renaming libnessus to libopenvas.

	* include/libnessus.h: Renamed to libopenvas.h.

	* include/libopenvas.h: New. Former libnessus.h.

2007-03-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libnessus: Renamed to libopenvas.

	* libopenvas: New. Former libnessus.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: New. Keep a list of issues/ideas/plans for this module.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvas-libraries.tmpl.in: Added header.

	* Makefile, libhosts_gatherer/Makefile, libnessus/Makefile: Added header.
	Renamed nessus.tmpl to openvas-libraries.tmpl.

	* libpcap-nessus/Makefile.in: Renamed nessus.tmpl to openvas-libraries.tmpl.

	* configure: updated.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus.tmpl.in: Removed (replaced by openvas-libraries.tmpl.in)

	* openvas-libraries.tmpl.in: Former nessus.tmpl

	* configure.in: Name change for .tmpl file.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Added header information.

	* ChangeLog: New. Summary of changes.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: Changed version number to 0.9.0 to not confuse with nessus
		versioning and to make clear that for OpenVAS this is not yet stable.
