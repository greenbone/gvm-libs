2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/openvas_ssh_login.c, nasl/capture_packet.c, nasl/exec.c,
	nasl/nasl_http.c, nasl/nasl_packet_forgery.c, nasl/nasl_scanner_glue.c,
	nasl/nasl_var.c: Replaced "includes.h" by respective includes where
	possible.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/openvas_logging.c: Added missing include, corrected doc and type
	of local variable.

	* misc/openvas_logging.h: Corrected type of variable.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* hg/hg_filter.c, hg/hg_debug.c, hg/hg_utils.c, hg/hg_subnet.c,
	hg/test.c, hg/hosts_gatherer.c, hg/hg_dns_axfr.c, hg/hosts_gatherer.h,
	hg/hg_add_hosts.c: Removed inclusion of includes.h, added missing
	includes.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/pcap.c: Cosmetics, doc.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/strutils.h, nasl/nasl_tree.c, nasl/nasl_signature.c,
	nasl/nasl_crypto2.c, nasl/preparse.c, nasl/md5.c, nasl/nasl_host.c,
	nasl/nasl_crypto.c, nasl/nasl_debug.c, nasl/nasl_socket.c,
	nasl/nasl_func.c, nasl/hmacmd5.c, nasl/nasl_text_utils.c, nasl/lint.c,
	nasl/nasl_misc_funcs.c, nasl/nasl_lex_ctxt.c, nasl/nasl_cmd_exec.c,
	nasl/nasl.c, nasl/nasl.h, nasl/regex.c, nasl/nasl_init.c,
	nasl/strutils.c, nasl/nasl_regex.h: Resolved "includes.h"-includes.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_socket.c: Major reformatting.

2009-09-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/comm.h, misc/openvas_logging.h: Whitespace removed.

	* misc/openvas_logging.c: Adjusted comments, resolved
	"includes.h"-include.

	* base/certificate.c: Cosmetics.

2009-09-23  Matthew Mundell <matthew.mundell@intevation.de>

	* misc/openvas_logging.c (free_log_configuration): Explicitly let go of
	the IO channel.
	(openvas_log_func): Change default_level to G_LOG_LEVEL_DEBUG, otherwise
	g_debug messages are always lost when this function is used for
	g_log_default_handler.  Use a temporary openvasd_logging pointer when
	searching through the domain list, else the second search could overwrite
	the log_domain_entry found in the first search.

	* misc/openvas_logging.h: Add rename @todo.

2009-09-23  Matthew Mundell <matthew.mundell@intevation.de>

	* misc/openvas_auth.c (openvas_set_user_role): New function.
	* misc/openvas_auth.h (openvas_set_user_role): New header.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* MANIFEST: Updated.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* packaging/debian/patches/, packaging/debian/, packaging/: Removed.
	These directories are now empty anyway. The packaging is kept
	is separate modules.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* VERSION: Set to 3.0.0.beta2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the openvas-libraries 3.0.0-beta1 release.

	* CHANGES: Updated.

	* VERSION: Set to 3.0.0.beta1.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/network.c: Cosmetics, doc.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/network.h, misc/network.c: Renamed ovas_server_context to
	ovas_scanner_context.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* CHANGES: Minor typo and grammar fix, added missing contributors.

	* ChangeLog: Fixed date.

2009-09-22  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl.c (init_hostinfos, sighandlers): Removed K&R function decls.
	Lowercased todo to be included in doxygen generated todo-list. Removed
	unneeded global variable.

	* nasl/hmacmd5.h: Removed whitespaces.

	* nasl/exec.c: Removed some whitespaces, lowercased todo kexwords to be
	included in doxygen generated todo-list. (exec_nasl_script) Partly
	reformatted. (init_nasl_library) Added todo. (nasl_exec) Added brief
	doc.

	* nasl/CMakeLists.txt: Removed unnecessary lines.

2009-09-21  Matthew Mundell <matthew.mundell@intevation.de>

	* omp/omp.c (G_LOG_DOMAIN): New define.

	* omp/xml.c (G_LOG_DOMAIN): New define.
	(read_entity_and_text): Remove stderr printing left over from manager.

	* misc/openvas_logging.c (openvas_log_func): Remove the day name from
	time_format to make the log prefix shorter.  Adjust the message tags
	slightly so the common messages line up nicely in the log.  Add a
	trailing newline to the message, to be consistent with the predefined
	glib loggers.  Flush two trailing whitespaces.
	(setup_log_handlers): Setup the default handler to openvas_log_func when
	the [*] group is present.  Correct two typos.  Neaten a function call.

	* misc/openvas_auth.c: Flush trailing blank lines.

	* misc/openvas_server.c: Offset all log messages in the same way.
	(G_LOG_DOMAIN): New define.

2009-09-21  Matthew Mundell <matthew.mundell@intevation.de>

	* CHANGES: Correct some typos, improve a bit of grammar.

2009-09-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas.pc.in: Raised glib dependency to 2.12.

	* configure: Updated

	* MANIFEST: Updated.

	* CHANGES: Added draft text for 3.0.0-beta1 release.

	* VERSION: Upgraded to 3.0.0.beta1.SVN

2009-09-21  Vlatko Kosturjak <kost@linux.hr>

	* configure.in: initial support for pkg-config for generating
	libopenvas.pc

2009-09-21  Vlatko Kosturjak <kost@linux.hr>

	* libopenvas.pc.in: new file, support for pkg-config

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/openvas_certificate_file.c: Commented another show_error,
	added todo regarding re-enabling of error-reporting.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/openvas_certificates.c, base/openvas_certificates.h: Renamed
	to openvas_certificate (stripped trailing s).

	* base/openvas_certificates.c, base/openvas_certificates.h
	(openvas_certificate_file_write): Changed signature and implementation,
	get GHashTable directly instead of a context containing it.

	* base/openvas_certificates.c, base/openvas_certificates.h,
	base/openvas_certificate_file.c, base/openvas_certificate_file.h,
	base/severity_filter.c: Updated includes,
	added workaround and todos regarding i18n.

	* MANIFEST: Updated content.

	* base/CMakeLists.txt: Updated.

	* Makefile: Install new headers.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Moved the openvas_certificate_file module from
	openvas-client/src/openvas-lib/.

	* base/openvas_certificate_file.c, base/openvas_certificate_file.h:
	Moved from openvas-client/src/openvas-lib/.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Moved the openvas_certificates module from
	openvas-client/src/openvas-lib/.

	* base/openvas_certificates.c, base/openvas_certificates.h: Moved from
	openvas-client/src/openvas-lib/.

2009-09-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Moved the severity_filter module from openvas-client/src/util.

	* src/util/severity_filter.c, src/util/severity_filter.h: Moved from
	openvas-client/src/util.

2009-09-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* nasl/nasl_misc_funcs.c, nasl/nasl_init.c,
	misc/services.h, misc/services.c, misc/services1.c,
	misc/scanners_utils.h, misc/resolve.h, misc/plugutils.h,
	misc/plugutils.c, misc/network.c, misc/ids_send.h,
	misc/ids_send.c: Renamed NESSUS to OPENVAS.

2009-09-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* nasl/nasl_udp.h, nasl/nasl_tcp.h, nasl/nasl_scanner_glue.h,
	nasl/nasl_raw.h, nasl/nasl_ip.h, nasl/nasl_icmp.h, misc/rand.h,
	misc/comm.h: Replace NESSUS by OPENVAS.

2009-09-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* omp/README.txt, base/README.txt: Fixed dependency info.

	* misc/services1.c, misc/network.c: Renamed Nessus to OpenVAS.

2009-09-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/README.BPF: Moved here from README.BPF.

	* packaging/fedora/openvas-libraries-1.0.1-1.fc8.openvas.spec,
	packaging/fedora/openvas-libraries-1.0.1-Makefile.diff,
	packaging/fedora/openvas-libraries-1.0.1-hg-Makefile.diff,
	packaging/opensuse/openvas-libraries-1.0.1-1.suse102.openvas.spec,
	packaging/opensuse/openvas-libraries-1.0.1-Makefile.diff,
	packaging/opensuse/openvas-libraries-1.0.1-hg-Makefile.diff:
	Removing hopelessly outdated packaging files.

	* MANIFEST: Updated.

2009-09-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* README.BPF: Replaced "nessusd" by "scanner".

	* INSTALL_README: Reworked.

	* configure.in: Upgraded dependency for glib from 2.6
	to 2.12 in accordance with CR #38.

2009-09-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/openvas_ssh_login.h, misc/openvas_ssh_login.c,
	nasl/nasl.c, nasl/nasl_signature.c, nasl/nasl_signature.h,
	nasl/nasl_text_utils.c, nasl/tests/test_blowfish.nasl,
	nasl/tests/test_bn.nasl, nasl/tests/test_dh.nasl,
	nasl/tests/test_dsa.nasl, nasl/tests/test_hexstr.nasl,
	nasl/tests/test_md.nasl, nasl/tests/test_privkey.nasl,
	nasl/tests/test_rsa.nasl, nasl/tests/testsuiteinit.nasl,
	nasl/tests/testsuitesummary.nasl: Copyright transfer
	from Intevation to Greenbone.

2009-09-18  Matthew Mundell <matthew.mundell@intevation.de>

	Make OMP interface names consistent.

	* omp/omp.c (omp_delete_task): Remove.
	(task_status, authenticate, env_authenticate, create_task)
	(create_task_from_rc_file, start_task, wait_for_task_start)
	(wait_for_task_end, wait_for_task_stop, wait_for_task_delete): Remove.
	Rename with omp_ prefix.
	(omp_task_status, omp_authenticate, omp_authenticate_env)
	(omp_create_task_rc, omp_create_task_rc_file, omp_start_task)
	(omp_wait_for_task_start, omp_wait_for_task_end, omp_wait_for_task_stop)
	(omp_wait_for_task_delete, omp_delete_task): New.  Renamed with prefix.
	* omp/omp.h: Update headers.

2009-09-18  Matthew Mundell <matthew.mundell@intevation.de>

	* misc/openvas_string.h: Match declaration names to definition names.

2009-09-18  Matthew Mundell <matthew.mundell@intevation.de>

	* misc/openvas_server.c (openvas_server_connect)
	(openvas_server_session_new, openvas_server_session_free): New functions.
	* misc/openvas_server.h: Add headers.

2009-09-17  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas-config.in (--libs): Add -lopenvas_omp.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed last OpenSSL-exception statement. openvas does not link openssl
	anymore.

	* nasl/nasl_scanner_glue.h: Removed OpenSSL-exception statement.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed the "OpenSSL-exception" from source files in the 'misc' module
	(the exception itself allows to do so). openvas does not link against
	openssl anymore.

	* misc/hash_table_file.c, misc/hash_table_file.h,
	misc/openvas_ssh_login.c, misc/openvas_ssh_login.h: Removed the OpenSSL-
	exception statement.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/bpf_share.c, misc/ftp_funcs.c, misc/harglists.c, misc/hlst.c,
	misc/hlst.h, misc/network.c, misc/resolve.c: Minor cosmetics

	* misc/ids_send.c, misc/kb.h, misc/openvas_logging.c,
	misc/openvas_server.c, misc/plugutils.c, misc/www_funcs.c: Replaced
	uppercase TODOs by lowercase todos, to be included in the
	doxygen-generated todo-list.

	* misc/plugutils.c (get_plugin_preference_fname): Documented,
	reformatted.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed the "OpenSSL-exception" from source files in the 'nasl' module
	(the exception itself allows to do so). openvas does not link against
	openssl anymore.

	* nasl/capture_packet.h, nasl/exec.h, nasl/nasl_cmd_exec.h,
	nasl/nasl_crypto2.h, nasl/nasl_debug.h, nasl/nasl_func.h,
	nasl/nasl_global_ctxt.h, nasl/nasl_host.h, nasl/nasl_http.h,
	nasl/nasl_init.h, nasl/nasl_lex_ctxt.h, nasl/nasl_misc_funcs.h,
	nasl/nasl_packet_forgery.h, nasl/nasl_socket.h, nasl/nasl_text_utils.h,
	nasl/nasl_tree.h, nasl/nasl_var.h, nasl/strutils.h: Removed the
	OpenSSL-exception statement.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Removed the "OpenSSL-exception" from source files in the 'base' module
	(the exception itself allows to do so). openvas does not link against
	openssl anymore.

	* base/hash_table_util.c, base/hash_table_util.h: Removed the OpenSSL-
	exception statement.

2009-09-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/nvti.c, nasl/nasl_cmd_exec.c, nasl/nasl_smb.c, nasl/nasl_wmi.c,
	nasl/strutils.c: Replaced uppercase TODOs by lowercase todos, to be
	included in the doxygen-generated todo-list.

	* nasl/lsearch.c (lfind): Added todo, as this source module seems to be
	obsolete.

	* nasl/nasl_socket.c: Cosmetics.

2009-09-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas-config.in: Added the top include dir
	to --cflags, so that #include <openvas/xxx.h>
	directives will work for the modules using
	openvas-libraries

2009-09-16  Matthew Mundell <matthew.mundell@intevation.de>

	Copy string utilities from manager to libs.

	* Makefile (install): Add openvas_string.h.

	* base/openvas_string.h, base/openvas_string.c: New files.

	* base/CMakeLists.txt (FILES): Add openvas_string.c.

	* MANIFEST: Add new files.

2009-09-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/rand.c, misc/network.c, misc/plugutils.c, misc/services1.c,
	misc/services.c, nasl/nasl_socket.c: Replaced "nessus" by
	"openvas" in function and struct names.

	* misc/rand.h, misc/network.h, misc/plugutils.h, misc/services1.h,
	misc/services.h: Adjusted protos accordingly.

2009-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/openvas-nasl.1, misc/arglists.c, misc/openvas_ssh_login.c,
	misc/system.c, nasl/nasl_scanner_glue.c: Renamed nessus to openvas.

2009-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/network.c: Renaming of nessus to openvas.

2009-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* nasl/nasl_nessusd_glue.c: Renamed to nasl/nasl_scanner_glue.c.

	* nasl/nasl_nessusd_glue.h: Renamed to nasl/nasl_scanner_glue.h.

	* nasl/nasl_init.c, nasl/nasl_scanner_glue.c, nasl/CMakeLists.txt:
	Adjusted to name change accordingly.

	* MANIFEST: Updated.

2009-09-15  Matthew Mundell <matthew.mundell@intevation.de>

	* base/CMakeLists.txt, nasl/CMakeLists.txt: Set project language to C,
	otherwise building requires a C++ compiler.  Improve some formatting.  Set
	policy CMP0005 to OLD.

	* omp/CMakeLists.txt: Set policy CMP0005 to OLD.

2009-09-15  Matthew Mundell <matthew.mundell@intevation.de>

	* omp/xml.c.BAK, omp/CMakeLists.txt.BAK, omp/README.txt.BAK,
	omp/omp.h.BAK, omp/omp.c.BAK, omp/xml.h.BAK: Remove accidentally committed
	backup files.

2009-09-15  Matthew Mundell <matthew.mundell@intevation.de>

	* omp/install_manifest.txt, omp/Makefile, omp/cmake_install.cmake,
	omp/CPackSourceConfig.cmake, omp/CMakeCache.txt, omp/CPackConfig.cmake,
	omp/CMakeFiles: Remove accidentally committed files.

2009-09-15  Matthew Mundell <matthew.mundell@intevation.de>

	Copy OMP client interface here from openvas-manager.

	* omp: New dir.

	* omp/CMakeLists.txt, omp/README.txt, omp/omp.c, omp/omp.h,
	omp/xml.c, omp/xml.h: New files.

	* MANIFEST: Add OMP lib files.

	* Makefile: Add OMP lib building.  Correct typo.  Flush trailing
	whitespace.

	* doc/Doxyfile, doc/Doxyfile_full: Add omp to include dirs.

	* misc/openvas_server.c	(openvas_server_open): Add const to arg.
	(openvas_server_send): Check if server closed connection, as in manager.

	* misc/openvas_server.h: Add include guard.
	(openvas_server_open): Add const to arg.

2009-09-15  Matthew Mundell <matthew.mundell@intevation.de>

	* ChangeLog: Flush whitespace.  Add spaces to headings.

2009-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/system.h: Added missing include. Again
	thanks to Marcus Brinkmann for finding this.

2009-09-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add support for certificates for GNUTLS connections.
	Developed by Marcus Brinkmann.

	* misc/network.c (ovas_allocate_connection): Add parameter
	certcred and handle credentials accordingly.
	(nessus_register_connection): Added parameter certcred and
	now handle credential based connections properly.
	(ovas_server_context_attach): Adapted to API change.

	* misc/network.h: Adjusted protos accordingly.

	* nasl/nasl_socket.c (nasl_open_privileged_socket): Adapted
	to API change.

2009-09-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/resolve.c (nn_resolve): memcpy now copies the right size.
	This was spotted and fixed by Marcus Brinkmann.

2009-09-11  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_signature.c (determine_gpghome): Fixed, as
	OPENVAS_SYSCONFDIR already points to a openvas subdir.

2009-09-11  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* MANIFEST: Added missing (new) files.

2009-09-11 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* base/nvticache.c: New. Implements a Cache for NVTIs.

	* base/nvticache.h: New. Accordingy protos.

	* base/CMakeLists.txt: Add handling of module nvticache.

	* misc/store.c (store_dir): Replaced by nvti_cache.
	(store_init): Added parameter "src". Changed Code
	to create a NVTI Cache object.
	(store_load_plugin): Don't do any file-based stuff
	anymore. Just ask the Cache for the NVTI for the
	given file.
	(store_plugin): Adaptapted to use the new location
	of the cache directory.

	* misc/store.h: Adjusted protos accordingly.

	* misc/plugutils.c (plug_set_cachefile, plug_get_cachefile):
	Removed. These are not required anymore since the NVTI Cache
	knows how to find it.
	(_plug_get_path): Removed.
	(plug_get_path): Now adds directly.

	* misc/plugutils.h: Adjusted protos accordingly.
	Remove old protos plug_get_fname and plug_set_fname
	for which no implementation is present.

2009-09-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_signature.c (init_openvas_gpgme_ctx): Removed test-surviving
	"static" keyword.

2009-09-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_signature.c: Changed uppercase @TODOs to lowercase @todos.

2009-09-10  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/Doxyfile, doc/Doxyfile_full: Added alias to generate todo list
	from both lower and uppercase @TODOs.

2009-09-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Install base/hash_table_util header, sort installation
	order of headers from base alphabetically.

2009-09-09  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/hash_table_util.c, base/hash_table_util.h: New. Implements
	generation of a list of the keys of a GHashTable.

	* base/CMakeLists.txt: Added new file to the FILEs list.

2009-09-08  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/arglists.h, misc/arglists.c: Moved declaration of struct
	name_cache to header, expose the cache_dec function.

2009-09-08  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Make check for libpcap more robust since it relied on a
	symbol that might be private in some environments. Fix suggested by
	Jan Wagner.

	* configure: Regenerated.

2009-09-08 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/plugutils.c (plug_set_cve_id, plug_set_bugtraq_id): NULL
	guard for parameter "id".

	* misc/store.c (store_load_plugin): Fix setting of CVE and  BID.

2009-09-07  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Preparing removal of rest of slightly differing arglists implementation
	from client by integrating changes into openvas-libraries.

	* misc/arglists.c (mkhash): Reformatted.

	* misc/arglists.c (cache_get_name, cache_add_name): Do not calculate
	hash value inside function, but expect it as parameter.

	* misc/arglists.c (cache_inc, cache_dec): Updated calls that require
	new parameter.

	* misc/arglists.c (arg_init_element, arg_add_value_at_head,
	arg_del_value): Added functions from clients implementation. Likely to
	be obsolete soon.

	* arglist.h: Added new protos.

2009-09-07 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing file "plugutils_internal.h". The only
	function defined there is moved to the only
	place where it is used.

	* misc/plugutils_internal.h: Removed.

	* misc/store.c (_add_plugin_preference): New. Moved
	here from plugutils.c.

	* misc/plugutils.c (_add_plugin_preference): Removed. Has
	gone to store.c.

	* misc/Makefile: Remove any occurance of
	plugutil_internal.h.

	* MANIFEST: Updated.

2009-09-07 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing file "store_internal.h". The only proto
	was about a function that does not exist anymore
	anyway.

	* misc/plugutils.c, misc/store.c: Don't include
	store_internal.h anymore.

	* misc/Makefile: Remove any occurance of store_internal.h.

	* misc/store_internal.h: Removed.

	* nasl/nasl_signature.c (nasl_extract_signature_fprs): Removed
	comments that is not true anymore.

	* MANIFEST: Updated.

2009-09-06 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Now by default add all information about NVT in the
	server arglist structures. This is the first step
	to further simplify the NVT information handling.

	* misc/store.c (store_fetch_version, store_fetch_summary,
	store_fetch_description, store_fetch_copyright, store_fetch_family,
	store_fetch_cve_id, store_fetch_bugtraq_id, store_fetch_xref,
	store_fetch_tag): Removed.
	(store_load_plugin): Always set version, description, copyright,
	family, cve_id, bugtraq_id, xref, tag and summary for plugin
	description.
	(store_plugin): Now uses the direct function for getting plugin
	attributes instead of the "_"-prefixed ones.

	* misc/store_internal.h: Adjusted protos accordingly.

	* misc/plugutils.c (plug_get_version, plug_get_summary,
	plug_get_description, plug_get_copyright, plug_get_family,
	plug_get_cve_id, plug_get_bugtraq_id, plug_get_xref, plug_get_tag):
	Directly deliver from present data.
	(_plug_get_version, _plug_get_summary, _plug_get_description,
	_plug_get_copyright, _plug_get_family, _plug_get_cve_id,
	_plug_get_bugtraq_id, _plug_get_xref, _plug_get_tag): Removed.
	(plug_set_version, plug_set_path, plug_set_cachefile): Guard NULL.

	* misc/plugutils_internal.h: Adjusted protos accordingly.

2009-09-06 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/store.c (store_fetch_path, store_fetch_oid,
	store_fetch_category): Removed. These are not used anywhere.

	* misc/store_internal.h: Adjusted protos accordingly.

2009-09-06 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/store.c (safe_copy): Removed. It is not used here
	anymore.

2009-09-06 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/network.c (nessus_perror): Renamed to pid_perror.

	* misc/services.h (NESSUS_SVC_SORT_FILES): Removed inactive define
	which is nowhere used anyway.
	(NESSUS_SVC_READS_ETC_SERVICES): Removed. This should always be used.

	* misc/services.c (nessus_get_svc_name): NESSUS_SVC_READS_ETC_SERVICES
	is always true.

2009-09-04 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/popen.c (append_argv, destroy_argv): Removed since the only
	module that used it is removed meanwhile.

2009-09-04 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/popen.c (nessus_popen4): Renamed to openvas_popen4.
	(nessus_popen): Removed. It is not used anywhere.
	(nessus_pclose): Renamed to openvas_pclose.

	* misc/popen.h: Adjust protos accordingly.

	* nasl/nasl_cmd_exec.c (nasl_pread): Adjust to new API accordingly.

2009-09-04  Michael Wiegand <michael.wiegand@intevation.de>

	* misc/openvas_auth.c (openvas_is_user_admin): Added new function to
	determine whether a user has administrative privileges.

	* misc/openvas_auth.h: Exposed openvas_is_user_admin.

2009-09-04 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/network.c (nessus_SSL_init): Renamed to openvas_SSL_init.
	Also removed the unused parameter.
	(open_SSL_connection, ovas_server_context_new): Adjusted call accordingly.

	* misc/network.h: Adjusted proto accordingly.

	* nasl/nasl.c (main): Adjusted to call of openvas_SSL_init.

2009-09-04  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Removed checks for libl and libfl which caused
	unnecessary linking against libl.

	* libopenvas-config.in: Removed handling of llib.

	* configure: Regenerated.

2009-09-04  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/strutils.c, nasl/strutils.h, nasl/nasl_cmd_exec.c, nasl_debug.c:
	Cosmetics, major reformatting.
	Added todos about possible replacement by glib and move to other part of
	openvas-libraries, doc.

	* nasl/nasl_var.c: Removed unnecessary include

2009-09-04  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/openvas_logging.c, misc/openvas_server.c,
	misc/openvas_ssh_login.c: Added todos regarding library reorganisation.

2009-09-04  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/plugutils.c: Removed K&R style function declarations,
	whitespaces, unused define, added doc and made a TODO indexable.

2009-09-04  Chandrashekhar B <bchandra@secpod.com>

	* nasl/nasl_host.c: (get_host_ip): Addressed an issue. The
	function was returning IPv6 mapped IPv4 address, now returns
	pure IPv4 address. Many applications won't accept v6 mapped v4.

2009-09-04  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.in: Corrected string comparison.

2009-09-04  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_signature (init_openvas_gpgme_ctx): Added call to
	gpgme_version_check which apparently initializes parts of gpgme.
	This might fix bug #972 or #1079 (http://bugs.openvas.org/1079).
	With help from Michael Wiegand.

2009-09-03 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/hash_table_file.c: Transferred copyright to Greenbone.
	Replaced includes.h by those needed really.

	* misc/hash_table_file.h: Transferred copyright to Greenbone.

2009-09-03  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Install nasl.h header.

2009-09-03  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.in: Corrected inverted logic: Add -lwmiclient to
	linker flags if libwmiclient found during configure step.

2009-09-03  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Pass HAVE_WMI client to cmake if libwmiclient was found
	during configure step.

	* libopenvas-config.in: Add -lwmiclient to linker flags if libwmiclient
	found during configure step.

	* nasl/CMakeLists.txt: Link against wmiclient if libwmiclient was found
	during configure step.

2009-09-03  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in, openvas-libraries.tmpl.in: Added support for
	libwmiclient detection.

	* configure: Regenerated.

2009-09-03  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/nasl_smb.c, nasl/nasl_wmi.c: Return NULL if no version info is
	available, as stated in the documentation. This avoid segfaults by
	unguarded calls strdup and strlen. Minor reformatting.

	* nasl/nasl_smb.c, nasl/nasl_wmi.c: Added TODOs about possible memleaks.

2009-09-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* configure: Regenerated.

2009-09-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/TODO: copied from openvas-nasl/TODO.

	* nasl/ChangeLog-pre-09-2009: Copied (soon old ChangeLog entries).

	* nasl/README.txt: New.

2009-09-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/CMakeLists.txt: Added target to build the openvas-nasl
	standalone interpreter (works at least on debian machines).

	* MANIFEST: Updated

2009-08-31 Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* misc/network.c (auth_send): Removed call of nessus_perror
	because the respective errno has changed at this moment already
	anyway.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.1, doc/libopenvas-config.1: Moved libopenvas-config
	manpage to doc.

	* Makefile: Install openvas-nasl manpage, adjusted path of
	libopenvas-config manpage.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/openvas-nasl.1, doc/signatures-howto.txt: Added, copied from
	openvas-libnasl/doc.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/tests/, nasl/tests/Makefile, nasl/tests/README.txt,
	nasl/tests/signed.nasl, nasl/tests/signed_nasl.asc,
	nasl/tests/test_blowfish.nasl, nasl/tests/test_bn.nasl,
	nasl/tests/test_db.nasl, nasl/tests/test_dsa.nasl,
	nasl/tests/test_hexstr.nasl, nasl/tests/md.nasl,
	nasl/tests/test_privkey.nasl, nasl/tests/test_rsa.nasl,
	nasl/tests/test_script_signing.sh, nasl/tests/testseuiteinit.nasl,
	nasl/tests/testsuitesummary.nasl: Added, copied from
	openvas-libnasl/test.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.in, configure.in: Added lopenvas_nasl and its
	dependencies (from openvas-libnasl-config) to the linker flags.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.in: Removed lopenvas_nasl from linker flags for now,
	as it breaks linking.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/network.c: Cosmetics, reformatted nsend, auth_send,
	nessus_perror and removed K&R styled function decls.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas-config.in: Added lopenvas_nasl to linker flags.

	* base/README.txt: Corrected.

2009-08-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* nasl/CMakeLists.txt: Modify output of custom bison target to remove
	generated files within the "clean" target, split long list over multiple
	lines.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	According to CR #38 (http://www.openvas.org/openvas-cr-38.html),
	libopenvas_nasl is now "part of" openvas-libraries.
	Expecting compilation issues due to skip of the old configure step.

	* doc/Doxyfile, doc/Doxyfile_full: Added nasl to include dirs.

	* nasl/CMakeLists.txt: Added not so clean way of compiling the parser.

	* MANIFEST: Added contents of nasl folder.

	* Makefile: Added nasl to all, install clean targets. Minor cosmetics.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Enabled build for the environment where the config was generated,
	preparing CR #38 (http://www.openvas.org/openvas-cr-38.html).

	* base/CMakeLists.txt: Removed duplicate (and commented) code.

	* nasl/CMakeLists.txt: Removed duplicate (and commented) code,
	added definition for OPENVAS_SYSCONF_DIR.

	* nasl/nasl_socket.c: Added include.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Attempts to enable build, preparing CR #38
	(http://www.openvas.org/openvas-cr-38.html).

	* nasl/capture_packet.c: Changed includes.

	* nasl/capture_packet.h: Added missing include.

	* nasl/CMakeLists.txt: Added libopenvas include directories, pass
	through variables.

	* nasl/nasl.c, nasl/nasl_init.c, nasl/nasl_ip.h,
	nasl/nasl_packet_forgery.c, nasl_raw.h, nasl_tcp.h: Changed includes.

	* Makefile: Removed. Is generated by CMake.

	* nasl/config.h: Added a generated config.h (from
	openvas-libnasl/includes) to enable compilation.

	* nasl/nasl_tcp.h, nasl/nasl_raw.h, nasl/nasl_icmp.h, nasl/nasl_ip.h,
	nasl/nasl_udp.h: Copied from openvas-libnasl/includes.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Copied contents of openvas-libnasl to openvas-libraries, preparing
	CR #38 (http://www.openvas.org/openvas-cr-38.html).

	* nasl/capture_packet.c, nasl/nasl_cmd_exec.c, nasl/nasl_host.c,
	nasl/nasl_misc_funcs.h, nasl/nasl_socket.h, nasl/preparse.c,
	nasl/capture_packet.h, nasl/nasl_cmd_exec.h, nasl/nasl_host.h,
	nasl/nasl_nessusd_glue.c, nasl/nasl_text_utils.c, nasl/preparse.h,
	nasl/exec.c, nasl/nasl_crypto2.c, nasl/nasl_http.c,
	nasl/nasl_nessusd_glue.h, nasl/nasl_text_utils.h, nasl/regex.c,
	nasl/exec.h, nasl/nasl_crypto2.h, nasl/nasl_http.h,
	nasl/nasl_packet_forgery.c, nasl/nasl_tree.c, nasl/smb_interface_stub.c,
	nasl/hmacmd5.c, nasl/nasl_crypto.c, nasl/nasl_init.c,
	nasl/nasl_packet_forgery.h,  nasl/nasl_tree.h, nasl/strutils.c,
	nasl/hmacmd5.h, nasl/nasl_crypto.h, nasl/nasl_init.h, nasl/nasl_regex.h,
	nasl/nasl_var.c, nasl/strutils.h, nasl/lint.c, nasl/nasl_debug.c,
	nasl/nasl_lex_ctxt_better.h, nasl/nasl_signature.c, nasl/nasl_var.h,
	nasl/wmi_interface_stub.c, nasl/lsearch.c, nasl/nasl_debug.h,
	nasl/nasl_lex_ctxt.c, nasl/nasl_signature.h, nasl/nasl_wmi.c,
	nasl/md5.c, nasl/nasl_func.c, nasl/nasl_lex_ctxt.h, nasl/nasl_smb.c,
	nasl/nasl_wmi.h, nasl/md5.h, nasl/nasl_func.h,
	nasl/nasl_misc_funcs_better.c, nasl/nasl_smb.h,
	nasl/openvas_smb_interface.h, nasl/nasl.c, nasl/nasl_global_ctxt.h,
	nasl/nasl_misc_funcs.c, nasl/nasl_socket.c,
	nasl/openvas_wmi_interface.h: Copied from openvas-libnasl/nasl.

	* nasl/includes.h, nasl/nasl.h: Copied from openvas-libnasl/include.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Preparing move of contents of  openvas-libnasl to openvas-libraries,
	according to CR #38 (http://www.openvas.org/openvas-cr-38.html).

	* nasl/, nasl/CMakeLists.txt: New.

2009-08-28  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Create own library for 'base'.

	* libopenvas-config.in: Added libopenvas_base to linker flags
	(libopenvas-config --libs).

	* Makefile: Added base to all, install and clean targets.

	* misc/Makefile: Removed targets that are now built 'in' base.

2009-08-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* base/README: Fixed glib version.

	* MANIFEST: Updated.

2009-08-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/network.h: Added missing include, resolves compiler warnings.

2009-08-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/arglists.c (mkhash): Switched to hash algorithm provided by glib.

2009-08-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/harglists.c: Added ifdef _WIN32 blocks from clients code.

	* misc/network.c (recv_line): Reformat and documentation like in clients
	version of the file.

2009-08-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* hg/hg_add_hosts.h: Removed proto for cmpipv6addrs as there
	is nowhere a implementation for this function.

2009-08-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* hg/hg_add_hosts.h: Removed proto for convipv4toipv4mappedaddr.

	* misc/network.h: Added proto for convipv4toipv4mappedaddr.

2009-08-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	First set of changes to openvas-libraries towards IPv6 support.
	This corresponds to Change Request #27,
	http://www.openvas.org/openvas-cr-27.html
	Most work done by Srinivasa NL <nl.srinivas@gmail.com>.

	* misc/resolve.c (nn_resolve): Use getaddrinfo instead of gethostbyname to
	resolve hostname.
	Return ip address in in6_addr structure.
	host2ip function is not used anymore.

	* misc/resolve.h: Adapted proto accordingly.

	* misc/plugutils.c (plug_get_host_ip): Change return type to in6_addr instead of in_addr type.

	* misc/plugutils.h: Adapted proto accordingly.

	* misc/network.c (convip4toipv4mappedaddr): New. Converts ipv4 address
	to ipv4 mapped ipv6 address.
	(open_socket): Added support for ipv6.
	(open_sock_opt_hn): Added support for ipv6.
	(set_socket_src_addr): Added additionaly paramter "family" and added
	support for ipv6.
	(open_sock_option): Added support for ipv6.

	* misc/network.h: Prototype of set_socket_src_addr adapted accordingly.

	* hg/hg_utils.c (hg_resolv): Added parameters in6addr and family.
	Use getaddrinfo instead of gethostbyname to resolve hostname.
	(hg_get_name_from_ip): Parameter ip now a pointer to in6_addr. Added support
	to handle ipv6 address.
	(hg_valid_ip_addr): New. Checks whether address is a valid ipv4 or ipv6 address.

	* hg/hg_utils.h: Modified and added prototype declararions correspondigly.

	* hg/hg_subnet.c (hg_gather_subnet_hosts): Use new interface of hg_get_name_from_ip.
	Works only for ipv4 targets.

	* hg/hosts_gatherer.c (hg_next_host): Changed paramter ip to in6_addr.
	Added support for ipv6.

	hg/hosts_gatherer.h: Adapted proto for hg_next_host.
	(struct hg_host): Added support for ipv6.

	* hg/hg_dns_axfr.c (hg_dns_fill_ns_addrs): Use newer hg_resolve which returns
	address of hostname in in6_addr type. Works only for ipv4 hosts.

	* hg/hg_add_hosts.c (getaddrfamily): New. Gets the family to which the given
	address belongs.
	(hg_add_host): Added support for ipv6.
	(hg_add_comma_delimited_hosts): Added support for ipv6.
	(hg_add_ipv6host_with_options): New. Adds ipv6 hosts to host list.
	(hg_add_host_with_options): Store ipv4 address as ipv4 mapped ipv6 address.

	* hg/hg_add_hosts.h: Extended and apdapted protos accordingly.

2009-08-26  Matthew Mundell <matthew.mundell@intevation.de>

	* base/CMakeLists.txt: New file.  Initial cmake building setup.

2009-08-25  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/openvas_ssh_login.c, misc/openvas_ssh_login.h: Cosmetics. Files
	now equal versions from openvas-client/src/openvas-lib again.

	* misc/system.c (emalloc): Added ifndef WIN_32 blocks from version
	in openvas-client. Files are otherwise nearly identical.

2009-08-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/arglists.c, misc/system.c: Cosmetics & doc, to increase
	similarity to arglist implementation in openvas-client.

	* misc/harglists.c (harg_inct): Added brackets around condition, like
	in openvas-clients version of this file.

	* misc/system.h: Removed if(n)defs for HUNT_MEM_LEAKS, as the otherwise
	defined functions like __hml_free could not be found to be implemented
	anywhere.

	* misc/hlst.c (create_hlst, copy_hlst): Added ifdef _WIN32
	conditioned code from openvas-client/libness/hlst.c.

2009-08-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* misc/plugutils.c: Added NULL-guard that is done in addslashes.c in
	openvas-client, equal comments.

2009-08-24  Tim Brown <timb@openvas.org>

	* base/nvti.c: Further format string fixes from Stephan Kleine.

2009-08-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/accessrules.c (accessrule_to_file): New, write a single rule to
	file
	(accessrules_to_file): Call accessrule_to_file for each rule
	(handle_start_element, handle_end_element, handle_text, handle_error):
	New, stubs for xmlparser
	(accessrules_from_file): Initialize xml parser.
	(accessrules_add): Added Null guard.
	Still incomplete, added TODOs.

2009-08-21  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/accessrules.c (accessrules_to_file, accessrules_from_file):
	Corrected doc.

	* base/accessrules.c (accessrule_version, accessrule_ip): Renamed
	function.

2009-08-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* base/accessrules.c: New. New implementation for access rules.
	Not finished yet.

	* base/accessrules.h: New. Respective Protos.

	* misc/Makefile: Added handling for module "accessrules".

2009-08-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* base/nvti.c: Fixed a few indentions and incomplete doc strings.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/README.txt: Removed second blank newline at eof.

	* hg/README.txt, misc/README.txt: New, describe 'state' of the
	directories.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* TODO, base/certificate.c, base/certificate.h, base/nvti.c,
	base/nvti.c, misc/openvas_logging.h: Updated paths in comments.

	* hg/Makefile: Updated include path for the test target.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As part of CR #38 (http://www.openvas.org/openvas-cr-38.html), renamed
	library libopenvas to libopenvasmisc.

	* misc/Makefile, libopenvas-config.in: Changed library name and
	output of libopenvas-config.

	* misc/openvas-logging.c: Changed path in comment.

	* doc/Doxyfile, doc/Doxyfile_full: Adjusted input path.

	* hg/Makefile: Changed include path.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* MANIFEST: Sorted.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As part of CR #38 (http://www.openvas.org/openvas-cr-38.html), renamed
	openvas-libraries/libopenvas folder to openvas-libraries/misc.

	* libopenvas/, misc/: Moved.

	* Makefile: Adjusted path.

	* MANIFEST: Adjusted paths.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/hlst.c (_hashqueue): Cosmetics, doc.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As part of CR #38 (http://www.openvas.org/openvas-cr-38.html), renamed
	libopenvas_hg to libopenvashg.

	* libopenvas-config.in: Adjusted output of 'libopenvas-config --libs'.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* hg/Makefile, include/libopenvas.h, libopenvas/plugutils.h,
	libopenvas/www_funcs.c, base/certificate.h: Cosmetics and docs.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As part of CR #38 (http://www.openvas.org/openvas-cr-38.html), renamed
	libopenvas_hg to libopenvashg.

	* hg/Makefile, TODO: Renamed library and references to it.

	* hg/test.c: Renamed library in comment.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/Doxyfile, doc/Doxyfile_full: Corrected path, libopenvas_hg is now
	hg.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As part of CR #38 (http://www.openvas.org/openvas-cr-38.html), renamed
	openvas-libraries/libopenvas_hg folder to openvas-libraries/hg.

	* libopenvas_hg/, hg/: Moved.

	* Makefile: Adjusted path.

	* MANIFEST: Adjusted paths.

2009-08-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas_hg/hg_add_hosts.c (hg_add_comma_delimited_hosts):
	Minimal cosmetics/doc.

2009-08-17  Matthew Mundell <matthew.mundell@intevation.de>

	* ChangeLog: Switch to full email address.

2009-08-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/services1.c (nessus_init_svc):
	Added RATS:ignore flag where memcopy limit is sane.

	* libopenvas/openvas_auth.c (get_password_hashes):
	Added RATS:ignore flag where statically sized buffer is sanely used.

2009-08-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c (nessuslib_version):
	Added RATS:ignore flag where statically sized char buffer is used
	in a sane manner.

2009-08-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c (proto_post_wrapped):
	Removed unused variable i.

2009-08-17  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/nvti.c (nvti_as_openvas_nvt_cache_entry):
	Corrected doc.

	* base/nvti.h (struct nvtpref):
	Made comments 'available' for doxygen, although these members should
	not be accessed directly.

2009-08-14  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_auth.c (openvas_authenticate): Improve doc.  Return 1
	on g_file_get_contents fail, as this is most probably an auth failure.

2009-08-14  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c (openvas_log_func): Add log_domain NULL
	guard.

2009-08-13  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c (setup_log_handlers): Adjust the * check
	so that the * case also goes on to the next item.

2009-08-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* doc/Doxyfile,
	doc/Doxyfile_full:
	Added 'base' to input paths.

2009-08-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/certificate.h (certificate_t, certificates_t):
	Converted documentation contained in comments of struct members, to
	be useable by doxygen.

	* ChangeLog:
	Improved wording.

2009-08-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* base/nvti.h:
	Converted documentation contained in comments of struct members, to
	be useable by doxygen.

2009-08-12  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h:
	Added support for the default group and tidying of comments.
	Fixed setup_log_handlers to load log domains from the configuration
	file.

2009-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* base/README.txt: Updated.

2009-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	According to CR #38 (http://www.openvas.org/openvas-cr-38.html) to
	reorganize openvas-libraries, this step prepares the "base" lib.

	* libopenvascommon: rename to "base".

	* base: The former directory "libopenvascommon".

	* Makefile, libopenvas/Makefile: replace all occurances of
	path "libopenvascommon" by "base".

	* MANIFEST: Updated.

2009-08-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/resolve.c: Removed definition of __u32 because
	it is not used anyway.
	Removed code that is deactivated since ever anyway.

2009-07-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* packaging/debian/control,
	packaging/debian/libopenvas2-dev.dirs,
	packaging/debian/compat,
	packaging/debian/libopenvas2.dirs,
	packaging/debian/libopenvas2-dev.install,
	packaging/debian/watch,
	packaging/debian/changelog,
	packaging/debian/patches/configure-grypt.dpatch,
	packaging/debian/patches/00list,
	packaging/debian/copyright,
	packaging/debian/libopenvas2.install,
	packaging/debian/rules:
	Removed.
	Was moved to /openvas-packaging/openvas-libraries/debian/trunk.

2009-07-27 Jan Wagner <Waja@cyconet.org>

	* packaging/debian/changelog, packaging/debian/control,
	packaging/debian/watch, packaging/debian/patches
	packaging/debian/patches/configure-grypt.dpatch
	packaging/debian/patches/00list, packaging/debian/copyright
	packaging/debian/rules:

	- relicense packaging to GPL-3
	- New upstream release
	- add configure-grypt.dpatch to get grypt working well
	- fixing DESTDIR in rules
	- Add debian/watch to detect when a new version is available at
	  wald.intevation.org
	- Bump Standards-Version to 3.8.2, no changes needed

2009-07-27  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h:
	Consistency in variable names.

2009-07-27  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c (level_int_from_string): New function.
	(load_log_configuration): Look for level names and integers when parsing
	the "level" key.

2009-07-27  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c: Improve spacing.  Remove @returns from
	void functions.  Make comment formats more consistent.  Shorten some
	comment lines.  Space @params as in other modules.

	* libopenvas/openvas_logging.h: Improve spacing.  Remove function
	descriptions.
	(openvasd_logging): Doxyfy docs.

2009-07-27  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h: Convert
	tabs to spaces.

2009-07-27  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	* libopenvas/openvas_logging.c:
	Indentation fixes.
	* libopenvas/openvas_logging.h:
	Indentation fixes.

2009-07-24  Michael Meyer <mime@gmx.de>

	* libopenvas/plugutils.c:
	Added line break to debug message because without it was not
	realy readable.

2009-07-24  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/Makefile:
	Thankfully applied patch of Stephan Kleine that closes bug 1037
	( http://bugs.openvas.org/1037 ).

2009-07-20  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c (openvas_log_func): Change the timeformat
	hour-minute-second separators, so that log_separator is unique.  Remove
	log_separator from the initialisation of "prepend", as prepend_buf always
	starts with the log separator.  Add a NULL guard to the creation of
	logstr.  Remove the newline from the stderr output case, so that it works
	the same as the channel case.
	(setup_log_handlers): Remove the openvasmd entry, which belongs in the
	manager.

2009-07-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add mandatory_keys to plugin arglist structure. This is part of
	implementing Change Request #39,
	http://www.openvas.org/openvas-cr-39.html.

	* libopenvas/store.c (store_load_plugin, store_plugin): Added
	handling for mandatory_keys.

	* libopenvas/plugutils.c (plug_mandatory_key): New. Sets
	mandatory keys.
	(plug_get_mandatory_keys): New. Gets mandatory keys.

	* libopenvas/plugutils.h: Added protos for plug_mandatory_key()
	and plug_get_mandatory_keys().

2009-07-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add mandatory_keys to NVTI. This is part of
	implementing Change Request #39,
	http://www.openvas.org/openvas-cr-39.html.

	* libopenvascommon/nvti.h: Added manadatory_keys
	to struct nvti and added respective protos.

	* libopenvascommon/nvti.c (nvti_free, nvti_add_pref,
	nvti_from_keyfile): Handle mandatory_keys.
	(nvti_mandatory_keys): New. Returns mandatory_keys.
	(nvti_set_mandatory_keys): New. Sets mandatory_keys.

2009-07-17  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c (openvas_log_func): Add log_domain NULL
	guard.  Correct typo.
	(setup_log_handlers): Add "openvasmd" entry.  Correct type in "openvas"
	entry.

2009-07-17  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/openvas_logging.c: Flush trailing whitespace.

2009-07-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/Makefile, libopenvas/services.h,
	libopenvas/services1.c: Renamed NESSUS_STATE_DIR to
	OPENVAS_STATE_DIR.

2009-07-12  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/rand.c: Removed emulation functions for lrand48 and
	srand48 since they were never exported. Updated comments.
	(nessus_init_random): Removed useless RATS: ignore statement.

2009-07-10  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Removed check for rand() since the result is not used anywhere.

	* configure: Regenerated.

	* include/config.h.in: Removed handling of HAVE_RAND.

2009-07-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* include/config.h.in: Removed NESSUSD_DIR, NESSUSD_REPORTS_DIR,
	NESSUSD_RULES, NESSUSD_USERS, NESSUSD_MESSAGES, PLUGINS_DIR:
	not used anywhere.

2009-07-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store_internal.h: Removed protos
	for non-existant functions store_save_init and
	store_save_end.

2009-07-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (proto_post_note): Readded a simple
	version. This needs some more engeneering to get rid of.

2009-07-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (proto_post_wrapped, proto_post_hole,
	proto_post_info, proto_post_debug): Removed unneeded returns.

2009-07-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (post_note, post_note_udp): Call
	proto_post_wrapped() directly instead of proto_post_note.
	(proto_post_note): Removed. This is a compatibility
	layer for the (ancient nessus-)times when "notes" where
	not supported (preference "ntp_client_accepts_notes").

2009-06-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.h: Added proto for plug_set_port_transport.

2009-06-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (plug_set_family, plug_set_name,
	plug_set_summary, plug_set_description, plug_set_copyright):
	Removed superfluous parameter "language".

	* libopenvas/plugutils.h: Adapted protos accordingly.

	* libopenvas/store.c (store_load_plugin): Adapted call of
	plug_set_family accordingly.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (plug_set_family, plug_set_name,
	plug_set_summary, plug_set_description, plug_set_copyright):
	According to CR#36, the language handling is removed.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store.c (store_fetch_required_udp_ports,
	store_fetch_required_udp_ports, store_fetch_excluded_keys,
	store_fetch_required_keys):
	Removed because never used anywhere.

	* libopenvas/store_internal.h: Removed corresponding
	protos.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store_internal.h (MAX_PREFS, MAGIC, pprefs, plugin):
	Removed all the uneeded makros and structs.
	(store_get_plugin): Removed proto for this nonexistant funciton.

	* libopenvas/store.c (store_load_plugin): Removed unused variable pp.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store.c(store_init_user, -store_init_sys): Remove these
	deprecated functions now that this code is heading for the next major
	release.

	* libopenvas/store.h: Remove respective protos.

2009-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store.c (store_get_plugin, store_get_plugin_f): Removed.
	These functions are not needed anymore.

2009-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvti_from_keyfile): Guard NULL pointer
	for g_convert.

2009-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvti_from_keyfile, nvti_to_keyfile): Before
	writing a copyright, description, name or summary, convert string to
	UTF8 and convert to latin-1 when reading it.

2009-06-15  Michael Wiegand <michael.wiegand@intevation.de>

	* ChangeLog: Corrected module name in last entry.

2009-06-15  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Added check for gcrypt.h which properly sets $LIBS so
	gcrypt can be correctly linked. This fixes the linker warnings described
	in Bug #1035 (http://bugs.openvas.org/1035) that occured if
	openvas-libraries was configured with LDFLAGS="-Wl,-z,defs"
	(--no-undefined).

	* configure: Regenerated.

2009-06-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Main part of the implementation for Change Request #33
	(Change server-side NVT cache from binary dumps to keyfiles),
	see http://www.openvas.org/openvas-cr-33.html.

	One important effect of this change is that in the cache
	directory news files with the suffix ".nvti" will be created.
	The old ".desc" files will remain there. These can be deleted.

	* libopenvas/store.c (str2arglist): Apply strchr
	only if the string is non-empty.
	(store_load_plugin, store_plugin, store_fetch_path,
	store_fetch_version, store_fetch_summary, store_fetch_description,
	store_fetch_copyright, store_fetch_family, store_fetch_oid,
	store_fetch_cve_id, store_fetch_bugtraq_id, store_fetch_xref,
	store_fetch_tag, store_fetch_required_keys, store_fetch_excluded_keys,
	store_fetch_required_ports, store_fetch_required_udp_ports):
	Replace handling from "desc" files to "nvti" files.

2009-06-11  Michael Wiegand <michael.wiegand@intevation.de>

	Included patch provided by Ryan Schmidt to remove a build failure on
	Mac OS X 10.4.11. This solves Bug #1033 (http://bugs.openvas.org/1033).

	* libopenvas/pcap.c: Changed order of includes.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	Post branch version bump.

	* VERSION: Set to 2.1.0.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.4.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/openvas_logging.c (openvas_log_func): Use g_strdup instead
	of g_strdup_printf to generate empty sting.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.3 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.3.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (post_note): Changed "#if 0" to "#if DEBUG" as
	recommended by Felix Wolfsteller to make the debug output available when
	debugging.

2009-06-10  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (post_note): Changed "#if 1" back to "#if 0" to
	remove stray debug output that was accidentally enabled in rev 2958.

2009-06-10  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h:
	Commenting in doxygen format
	Compile warning fixes

	* openvas-libraries.tmpl.in: Fix for an unintended gthread
	dependency

2009-06-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Make sure the string
	written does not exceed the maximum buffer size.

2009-06-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Added
	support of subdirectories).

2009-06-08  Michael Wiegand <michael.wiegand@intevation.de>

	* MANIFEST: Added missing entries.

2009-06-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/store.c (store_dump_plugin): Removed. This
	function was deactivated anyway.

2009-06-05  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvas/network.c (open_SSL_connection)
	(ovas_server_context_attach): Remove EAGAIN and EINTR checks added on
	2008-11-17 (revision 1769), as GNU TLS always returns its own error
	codes.

2009-06-05  Matthew Mundell <matthew.mundell@intevation.de>

	Improve naming of nvtis functions.

	* libopenvascommon/nvti.c (nvtis_new, nvtis_free, nvtis_add)
	(nvtis_lookup): New functions, renamed from make_nvtis, free_nvtis,
	add_nvti and find_nvti.
	(make_nvtis, free_nvtis, add_nvti, find_nvti): Remove.
	* libopenvascommon/nvti.h: Update headers.

2009-06-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvas/plugutils.c (plug_set_sign_key_ids): If
	the key_ids are NULL, then don't add "SIGN_KEY_IDS" to the
	plugin description at all.

2009-06-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.c (nvtpref_add_to_keyfile): Removed
	this callback function as it is not needed anymore.
	(nvti_to_keyfile): Create generic keys "P1" .. "Pn" instead
	of using the preferences names, because those can sometimes
	contain chracters that are invalid for keys.
	Also, replace fprintf by fputs to avoid interpretation of %.

2009-05-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* libopenvascommon/nvti.h: Added data structure nvtpref_t and
	associated functionprotos for handling NVT preferences.
	(nvti_t): Extended to handle its preferences.

	* libopenvascommon/nvti.c (nvtpref_new, nvtpref_free,
	nvtpref_name, nvtpref_type, nvtpref_default): New. For
	handling nvtpref objects.
	(nvti_free, nvti_from_keyfile, nvti_to_keyfile): Handle
	preferences accordingly.
	(nvti_pref_len, nvti_pref, nvti_add_pref,
	nvtpref_add_to_keyfile): New.
	(nvti_to_keyfile): Fix bug: release text only when it is
	really allocated.

2009-05-29  Matthew Mundell <matthew.mundell@intevation.de>

	Add certificate facilities.

	* libopenvascommon/certificate.h, libopenvascommon/certificate.c: New
	files.

	* libopenvas/Makefile: Add libopenvascommon/certificate.

	* Makefile: Install libopenvascommon/certificate.h.

2009-05-28  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Rename gerror to error.  Free
	error after use.  Add error->message to error message.

2009-05-28  Matthew Mundell <matthew.mundell@intevation.de>

	Add type nvtis for collections of NVT Infos.

	* libopenvascommon/nvti.c (free_nvti_for_hash_table, make_nvtis)
	(free_nvtis, nvtis_size, add_nvti, find_nvti): New functions.

	* libopenvascommon/nvti.h: Update headers.  Add single include guard.

	* ChangeLog: Add log missed yesterday.

2009-05-28  Felix Wolfsteller  <felix.wolfsteller@intevation.de>

	* libopenvascommon/nvti.c (nvti_to_keyfile): Fixed mem leak by freeing
	text, added TODO as function returns 0 also in case of errors.

2009-05-27  Matthew Mundell <matthew.mundell@intevation.de>

	* Makefile (install): Install libopenvascommon/nvti.h.

2009-05-27  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvascommon/nvti.c: Correct function name.

2009-05-27  Matthew Mundell <matthew.mundell@intevation.de>

	* libopenvascommon/nvti.h, libopenvascommon/nvti.c: Reformat to match
	standard.

2009-05-27  Matthew Mundell <matthew.mundell@intevation.de>

	* ChangeLog: Flush trailing whitespace.

2009-05-27  Laban Mwangi <lmwangi@penguinlabs.co.ke>

	Adding initial support for logging.

	* libopenvas/openvas_logging.c, libopenvas/openvas_logging.h: New.
	Shared logging functions.

	* libopenvas/Makefile openvas-libraries.tmpl.in Makefile: Updated.

	* MANIFEST: Updated.

2009-05-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adding a initial version for NVT Info objects.

	* libopenvascommon/, libopenvascommon/nvti.h,
	libopenvascommon/nvti.c, libopenvascommon/README.txt: New.
	A module for handling NVT Info objects.

	* libopenvas/Makefile: Added handling of module
	"libopenvascommon/nvti".

	* MANIFEST: Updated.

2009-05-19  Matthew Mundell <matthew.mundell@intevation.de>

	Add authentication facilities.

	* libopenvas/openvas_auth.c: New file.  Contains functions digest_hex and
	get_password_hashes from ../config-manager/src/openvascd.c.
	* libopenvas/openvas_auth.h: New file.

	* libopenvas/Makefile (openvas_auth.o): New rule.

	* Makefile (install): Add openvas_auth.h.
	(doc-full): Fix comment typo.

2009-05-18  Matthew Mundell <matthew.mundell@intevation.de>

	* doc/Doxyfile (EXTRACT_ALL): Turn off, to enable warnings about
	missing function docs.

2009-05-13  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store.c: (store_plugin) Don't try to guess the path of the
	NVT, this resulted in wrong paths. The filename is enough for the error
	message built by safe_copy. (safe_copy) Display a more descriptive error
	message. Clarified documentation, made variable name more fitting.

2009-05-05  Jan Wagner <waja@cyconet.org>

	* packaging/debian/copyright, packaging/debian/changelog: Added some
	copyright notices and bumped version number

2009-04-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/openvas_server.c (openvas_server_sendf): Fixed forgotten name change.

2009-04-17  Michael Wiegand <michael.wiegand@intevation.de>

	* packaging/debian/patches/: Removed. It contained a single patch which
	has already been incorporated into the trunk.

2009-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c: Removed any code path for conditional
	NESSUS_CNX_LOCK. This was a "Quick & dirty patch to run Nessus
	from behind a picky firewall (e.g. FW/1 and his 'Rule 0'): Nessus
	will never open more than 1 connection at a time."
	It appears to be deseperately outdated and never used.
	OpenVAS allows to configure the number of concurrent checks,
	so this should be the way to go in case of firewall-based problems.

2009-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/openvas_server.h, libopenvas/openvas_server.c
	(openvas_server_connect_to_server): Renamed to openvas_server_open.
	(openvas_server_close_server_connection): Renamed to openvas_server_close.
	(openvas_server_send_to_server): Renamed to openvas_server_send.
	(openvas_server_sendf_to_server): Renamed to openvas_server_sendf.

2009-04-15  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/openvas_server.c: Made function names more intuitive,
	removed superfluous newlines from log messages, added a little
	documentation.

	* libopenvas/openvas_server.h: Made function names more intuitive,
	removed superfluous include.

2009-04-14  Michael Wiegand <michael.wiegand@intevation.de>

	Added a new library for GnuTLS based communication, based on work done
	by Matthew Mundell for the openvas-manager module.

	* libopenvas/openvas_server.c: New. Contains an initial set of function
	for GnuTLS based communication.

	* libopenvas/openvas_server.h: New. Header file for the new
	functionality.

	* libopenvas/Makefile: Updated.

	* Makefile: Updated.

	* MANIFEST: Updated.

2009-04-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c (mark_post): Fixed a probably unintended
	change in r2958 by Felix.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Corrected search path for signature files when comparing their
	timestamps in store module.
	Declared two parameter of store_load_plugin as const.

	* libopenvas/store.c, libopenvas/store.h (store_load_plugin): Made
	parameters const, corrected search path for .asc (signature) files. Was
	cache dir, now is same dir as plugin.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Corrected checks when loading plugins from cache, extended
	documentation, removed debug printf.

	* libopenvas/store.c (store_load_plugin): Corrected checks and doc.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	More reformatting and documentation work in store module.

	* libopenvas/store.c: Reformatting, doc.

2009-04-01  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Reformatting and documentation work in store module.

	* libopenvas/store.c: Reformatting, doc.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Disabled checking for non-printable chars when posting security
	messages. This allows localizations and support for e.g. german or
	french characters in the messages text.
	It is unclear why this behaviour was wished (in order to prevent NTP
	corruption?).

	* libopenvas/plugutils.c (proto_post_wrapped): Disabled replacement
	of non-printable characters by spaces.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c: Reformatting, whitespace-removal, K&R style
	replacements, doc.

2009-03-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* Makefile: Phony target doc-dev is actually called doc-full.

2009-03-27  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/Makefile, libopenvas_hg/Makefile: Adjusted libtool calls to
	remove warnings about deprecated libtool usage during compile.

2009-03-06  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* doc/Doxyfile, doc/Doxyfile_full: Set PROJECT_NUMBER to 2.0.3.SVN.

	* VERSION: Set to 2.0.3.SVN.

2009-03-06  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.2 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.2.

2009-03-04  Vlatko Kosturjak <kost@linux.hr>

	* libopenvas/bpf_share.c: by default, put pcap device in non
	blocking mode - fixing plugins hang/freeze, fixes #901

2009-02-27  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h:
	Updated to version used in client:
	Updated ssh_login struct to carry password as well, cosmetics and
	memleak- fix (done in openvas-client rev 2597 & 2599).

2009-02-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvs/www_funcs.c (build_encode_URL): Fixed
	string length calculation. Thanks to
	Michael Meyer who spotted this and sent this patch!

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control: Fixed minor typo.

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/Makefile: Forward ported fix for broken linking.

2009-02-22  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: New upstream release.

	* packaging/debian/control: Updated the control file to take account
        of translation work as part of the Smith review project.

	* packaging/debian/patches/00list,
	packaging/debian/patches/linker-libs.dpatch, packaging/debian/rules:
	Fixed broken linking (linker-libs.dpatch).

2009-02-14  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/openvas_ssh_login.c (openvas_ssh_login_file_write):
	Close file descriptor in case of error.

2009-02-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* doc/Doxyfile_full: Makes the resulting documentation even
	more comprehensive. Switch off Latex output.

	* Makefile: make src doc latex creation conditional to presence
	of respective directories.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.2.SVN.

	* doc/Doxyfile, doc/Doxyfile_full: Updated PROJECT_NUMBER.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Last minute fixes for the openvas-libraries 2.0.1 release.

	* MANIFEST: Updated.

	* Makefile: Fixed targets "clean" and "distclean" to correctly remove
	generated HTML documentation.

2009-02-06  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.1 release.

	* VERSION: Set to 2.0.1.

	* CHANGES: Updated.

	* include/libopenvas.h: Added Doxygen directives to include README and
	COPYING files into HTML documentation.

	* ChangeLog: Cleanup.

	* libopenvas/COPYING: Moved to COPYING, a more obvious location.

	* doc/Doxyfile, doc/Doxyfile_full: Updated version, set EXAMPLE_PATH.

	* README: Added.

2009-02-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Minor cosmetics, improved documentation.

	* libopenvas/kb.h: Documentation & formatting of kb_item struct.

	* libopenvas/services1.c: Added file flag for doc block, removed
	whitespaces.

	* libopenvas/resolve.c (host2ip) : Documented return code.

	* libopenvas/system.c (emalloc): Converted doc block.

	* libopenvas/network.c: Converted documentation blocks.

	* libopenvas/rand.c: Added file flag for doc block.

	* libopenvas/store.c: Removed structuring comments, function safe_copy
	documented.

2009-02-06  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Copied GPL Header from host_gatherer.c over to host_gatherer.h,
	cosmetics and doc.

	* libopenvas_hg/host_gatherer.c: Documentation, K&R function decl.
	replaced.

	* libopenvas_hg/host_gatherer.h: Copied GPL header from modules
	implementation file, doc strings converted.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/hash_table_file.c: Documentation improved, newlines.

2009-02-05  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/ids_send.c (which_ttl): Added RATS ignore and a comment
	explaining the rationale.

2009-02-05  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/system.c (erealloc): Removed misleading comment; the
	function is indeed defined in libopenvas/system.h and is used in a
	number of places in openvas-libraries.

2009-02-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Cosmetics and documentation in kb module.

	* libopenvas/kb.c: Added empty lines in comment blocks to improve
	readability (thanks matt), added briefs to comment blocks, removed
	/* within a comment block to avoid compiler warning (thanks michael),
	donated return types own line.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/config.h.in: Removed define of "DEFAULT_PORT"
	which is not used anywhere (it defaulted to ancient 3001).
	Removed define of "CLIENT_TIMEOUT". It is not used anywhere.
	Removed define of "SERVER_TIMEOUT". It is not used anywhere.
	Removed define of "LOGMORE". It is not used anywhere.
	Removed define of "NESSUSD_KEYFILE", "NESSUSD_USRKEYS",
	"NESSUSD_KEYLENGTH" and "NESSUSD_MAXPWDFAIL".  These are
	not used anywhere.
	Removed define of "PLUGIN_TIMEOUT". It is not used in
	this module.
	Removed define of "LOG_WHOLE_ATTACK". It is not used in
	this module.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed any code path that is conditional to "ENABLE_RHLST".
	It was never used, especially because it would require a file
	"rhlst.h" which isn't present at all.

	* libopenvas/hlst.h: Removed any code path that
	is conditional to "ENABLE_RHLST".

	* libopenvas/hlst.c: Removed any code path that
	is conditional to "ENABLE_RHLST".

	* include/config.h.in: Removed undef for ENABLE_RHLST.

2009-02-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some cleanups. Basically removing never-used code.

	* libopenvas/plugutils.c (is_shell_command_present): Removed.
	It is not used anywhere except in
	openvas-plugins/plugins/nmap_wrapper/nmap_wrapper.c for
	very ancient NASL level.

	* libopenvas/plugutils.h: Removed proto accordingly.

	* libopenvas/popen.c (nessus_popen4): Removed unused
	code that is deaactivcated with "#if 0".
	(append_argv, destroy_argv): marked as to be deleted
	eventually.

	* libopenvas/network.c (nessus_print_SSL_certificate,
	nessus_print_peer_SSL_certificate): Removed. It is unused
	code that was deactivcated with "#if 0".
	(nsend): Removed unused code that was deactivated with
	"#if 0".

2009-01-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): When creating a
	cache file for a plugin, now take care a subdirectory
	is created in the cachefolder - in case the plugin
	is located in a subfolder of the plugin folder accordingly.

2009-01-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): Fixed a bug: In
	case of using cache_folder, the wrong filenames for the
	actual plugin file where written into the cache file.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_init): Also handle NULL
	for its parameter.

2009-01-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_dir, store_init): Improved
	comments and made implementation more robust.
	store_init will not anymore try to create the directory.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Changed API (new parameter in openvas_ssh_login_file_read). Fixes build
	of latest openvas-server.

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h:
	Changed file headers to indicate that they are part of
	openvas-libraries.

	* libopenvas/openvas_ssh_login.c (openvas_ssh_login_file_read): Added
	parameter check_keyfiles to allow exclusion/inclusion of logins that
	are lacking pub/private key files, included parameter in documentation.

	* libopenvas/openvas_ssh_login.h: Adjusted proto for
	openvas_ssh_login_file_read.

2009-01-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.h: Applied gcc deprecation marker
	for deprecated functions.

2009-01-20  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/Makefile: Fixed typo in LO_OBJS which caused the build to
	fail on amd64.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added make targets for openvas_ssh_login module.

	* libopenvas/Makefile: Included openvas_ssh_login module.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Inclusion of openvas_ssh_login module (copy from client).

	* libopenvas/openvas_ssh_login.c, libopenvas/openvas_ssh_login.h: Added.

	* MANIFEST, Makefile, libopenvas/Makefile: Updated.

2009-01-20  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Inclusion of hash_table_file module (copy from client).

	* libopenvas/hash_table_file.c, libopenvas/hash_table.h: Added.

	* MANIFEST, Makefile, libopenvas/Makefile: Updated.

2009-01-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* ChangeLog: Clarified last ChangeLog entry (choice of GPL header).

	* libopenvas_hg/hg_utils.c: Replaced K&R function declarations,
	documentation.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Added GPL header from host_gatherer.c to other constituent files of
	the host_gatherer library (referenced as "HostLoop2 library" in
	hg_add_host.c).

	* libopenvas_hg/hg_debug.c, libopenvas_hg/hg_filter.h,
	libopenvas_hg/test.c, libopenvas_hg/hg_utils.h,
	libopenvas_hg/hg_subnet.h, libopenvas_hg/hg_dns_axfr.h,
	libopenvas/hg_add_hosts.h : Added GPL header.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas_hg/hg_filter.c: Replaced K&R function headers, transformed
	comments to javadoc style, removed some whitespaces.

2009-01-12  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas_hg/hg_add_hosts.c (hg_add_comma_delimited_hosts):
	Reformatted.

2009-01-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_load_plugin): Fixed memory leaks.

2009-01-04  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Name change for cached ("description") files for NVTs.
	They used to have the suffix ".desc" instead of ".nasl"
	but they now have the very same name as the corresponding NVT
	plus additional suffix ".desc", e.g. "x.nasl" will be "x.nasl.desc".
	This also prevents that e.g. "x.nasl" and "x.nes" (or "x.oval")
	will overwrite each others' cache.

	It is recommendable to clean the .desc directory to
	avoid unnecessary old cache files.

	* libopenvas/store.c (store_plugin): Added doc string and
	now uses g_build_filename to assemble filenames instead
	of doing this on our own. Append ".desc" rather than replace
	a present suffix.
	(store_load_plugin): Updated doc string and now uses
	g_build_filename to assemble filenames instead
	of doing this on our own. Append ".desc" rather than replace
	a present suffix.
	Set the full path as cachefile.
	(store_get_plugin_f): Aggregated params "dir" and "file"
	into "desc_file". Thus removed code to assemble name on
	our own.
	(store_get_plugin): Adapted call of store_get_plugin_f
	accordingly, assuming the given desc_file is the full path
	to the cache file.

2009-01-03  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c (store_plugin): change return value to
	void, because the function never returns something else than
	NULL. Also any use of the method does not consider a return value
	at all. Thus cleaning up this method.

	* libopenvas/store.h: Updated proto of store_plugin accordingly.

2009-01-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing the handling of separate user-specific cache dir.
	This code are remains of the unsecure feature of plugin
	upload. Apart from this, the OpenVAS Server should eventually
	not be responsible anymore for user-specific data storage.

	* libopenvas/store.c (usr_store_dir, sys_store_dir, current_mode):
	Removed these static variables as they are not needed anymore.
	(store_dir): New. Static variable to hold the cache dir.
	(MODE_SYS, MODE_USR): Removed these macros as they are not needed any
	more.
	(store_init, store_init_sys): Use store_dir instead of sys_store_dir.
	(store_init_user): Removed functionality and marked as deprecated.
	Now it simply calls store_init_sys().
	(store_get_plugin): Reduced functionality to direct call of
	store_get_plugin_f(), because distinction between user and sys
	not necessary anymore.
	(store_plugin): Removed distinction between sys and user.

2009-01-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Further patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/store.c (store_init_sys): Marked as deprecated.
	(store_init): New. Simply sets the "sys_store_dir" without appending
	".desc".
	(store_get_plugin): Renamed param "name" to "desc_file".

	* libopenvas/store.h: Added proto for store_init.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	Added missing includes to enable compilation on Darwin and NetBSD,
	based on suggestions by Adrian Portelli.  This solves parts of bug
	#860 (http://bugs.openvas.org/860) and bug #862
	(http://bugs.openvas.org/862).

	* libopenvas/pcap.c: Added missing include for netinet/in.h.

	* libopenvas/plugutils.c: Changed to use sys/wait.h instead of wait.h.

	* libopenvas/bpf_share.h: Added missing include for sys/types.h.

	* libopenvas/popen.c: Added missing include for sys/resource.h.

2009-01-02  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/kb.c: Documentation.

2009-01-02  Michael Wiegand <michael.wiegand@intevation.de>

	* configure: Regenerated to completely remove --enable-debug-store.

2009-01-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	More patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/store.c: Replaced any call of plug_get_fname
	by plug_get_cachefile.
	(store_load_plugin): Replaced call of plug_set_fname by
	plug_set_cachefile.

	* libopenvas/plugutils.c (plug_get_fname, plug_set_fname): Removed.

2008-12-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	As Result of CR #20, added two doxygen configuration files and targets
	to generated source documentation.

	* doc/Doxyfile: Added. Basic configuration file.

	* doc/Doxyfile_full: Added. Enables graph generation.

	* Makefile: Targets 'doc' and 'doc_full' added, 'clean' altered, such
	that it will remove generated documentation found in doc/generated.

2008-12-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, include/config.h.in: Removed any remains
	of DEBUG_STORE as it is not used anywhere in the code.
	This also removed the configure option "--enable-debug-store".

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.c: Removed OLD_CVE_SZ, OLD_BID_SZ and
	OLD_XREF_SZ and their use because this is only meant
	to support rather old version of Nessus.
	The removed code was conditionally for DEBUG_STORE anyway.

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing unused code.

	* libopenvas/store.c (store_fetch_dependencies, store_fetch_timeout,
	store_fetch_name):
	Removed. This function is never called since a long time.

	* libopenvas/store_internal.h: Removed proto for
	store_fetch_dependencies, store_fetch_name and store_fetch_timeout.

	* libopenvas/plugutils.c (plug_get_deps, plug_get_timeout,
	plug_get_name):
	Removed code that is never executed.

	TODO: Added note on the broken concept of plugutils/store
	calling each other.

2008-12-30  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/kb.h: Comments.

	* libopenvas/kb.c: Transformed comments to javadoc, slight doc
	improvements.

2008-12-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Reduced the middle layer of the plugin functions that do not
	use the cache.

	* libopenvas/store.c (store_plugin): Replace call of _plug_get_id()
	by plug_get_id() and dito for several other functions (see below).

	* libopenvas/plugutils_internal.h: Removed unneeded protos.

	* libopenvas/plugutils.c (plug_get_id): Moved contents of
	_plug_get_id here.
	(_plug_get_id): Removed.
	(plug_get_oid): Moved contents of _plug_get_oid here.
	(_plug_get_oid): Removed.
	(plug_get_required_keys): Moved contents of _plug_get_required_keys here.
	(_plug_get_required_keys): Removed.
	(plug_get_excluded_keys): Moved contents of _plug_get_excluded_keys here.
	(_plug_get_excluded_keys): Removed.
	(plug_get_required_ports): Moved contents of _plug_get_required_ports here.
	(_plug_get_required_ports): Removed.
	(plug_get_required_udp_ports): Moved contents of
	_plug_get_required_udp_ports here.
	(_plug_get_required_udp_ports): Removed.
	(plug_get_deps): Moved contents of _plug_get_deps here.
	(_plug_get_deps): Removed.
	(plug_get_timeout): Moved contents of _plug_get_timeout here.
	(_plug_get_timeout): Removed.
	(plug_get_name): Moved contents of _plug_get_name here.
	(_plug_get_name): Removed.
	(plug_get_fname): Moved contents of _plug_get_fname here.
	(_plug_get_fname): Removed.
	(plug_get_category): Moved contents of _plug_get_category here.
	(_plug_get_category): Removed.

	* libopenvas/kb.h: Added a note on NEW_KB_MGMT.

2008-12-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some patches by Stjepan Gros in preparation of
	Change Request #24 (subdirs for NVTs,
	http://www.openvas.org/openvas-cr-24.html).

	* libopenvas/plugutils.c (plug_set_cachefile): New. Sets the "CACHEFILE".
	(plug_get_cachefile): News. Retrieves the "CACHEFILE".

	* libopenvas/plugutils.h: Added protos for plug_set_cachefile
	and plug_get_cachefile.

2008-12-20  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas_hg/Makefile, libopenvas/Makefile,
	openvas-libraries.tmpl.in: Honour LDFLAGS.

2008-12-19  Michael Wiegand <michael.wiegand@intevation.de>

	* configure: Regenerated to include fix for Mac OS X.

2008-12-19  Tim Brown <timb@nth-dimension.org.uk>

	* configure.in: Improved #761, should now work on Mac OS X where
	__dn_expand does not exist.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.1.SVN.

2008-12-17  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0.0 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.

2008-12-16  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils_internal.h: Added declaration of _plug_get_tag.

2008-12-16  Michael Wiegand <michael.wiegand@intevation.de>

	Updated build environment to use an up-to-date libtool version.

	* config.guess, config.sub, ltmain.sh: Regenerated.

2008-12-10  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/proctitle.c (setproctitle): Reverted one instance of
	strncpy usage back to strcpy since it causes issue on server startup
	under certain circumstances.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.rc2.SVN.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the openvas-libraries 2.0-rc1 release.

	* CHANGES: Updated.

	* VERSION: Set to 2.0.0.rc1.

2008-12-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	* libopenvas/plugutils.c : Changed comment style, added param
	documentation for plug_set_sign_key_ids.

2008-12-05  Michael Wiegand <michael.wiegand@intevation.de>

	Checking for potential code quality issues ahead of the 2.0-rc1
	release, setting ignore flags for false positives and using more
	secure functions for certain string manipulations.

	* libopenvas_hg/test.c (main): Don't warn against getopt usage, it is
	not critical here since this application is only intended for
	demonstration purposes.

	* libopenvas/pcap.c (get_random_bytes): Ignore warning, this random
	seed is random enough for our purposes.

	* libopenvas/plugutils.c: (plug_set_cve_id, plug_set_bugtraq_id,
	plug_set_xref, plug_set_tag, proto_post_wrapped) Ignore warnings
	regarding strcat since the memory is allocated correctly before
	calling strcat. (host_add_port_proto, kb_get_port_state_proto,
	mark_successful_plugin, mark_post, add_plugin_preference,
	proto_post_wrapped, scanner_add_port, plug_set_port_transport,
	plug_get_port_transport, plug_set_ssl_item, find_in_path) Ignore
	warnings regarding snprintf since libc4 (where snprintf is a security
	issue) is most certainly not present on system able to compile and run
	openvas-libraries. (plug_get_key, plug_get_host_open_port) Ignore
	warnings about lrand48 being not random enough; it is random enough
	for the usage here. (find_in_path) Removed obsolete code, change
	sprintf usage to snprintf.

	* libopenvas/network.c: (get_encaps_name, get_encaps_through,
	open_sock_tcp, auth_printf) Ignore (v)snprintf warnings; see above.
	(_socket_get_next_source_addr) Ignore warning about lrand48; see
	above.

	* libopenvas/network.h: Ignore false positive in function declaration.

	* libopenvas/proctitle.c: (initsetproctitle) Changed ignore flag to
	RATS so both flawfinder and RATS honor it. (setproctitle) Ignore
	snprintf warnings (see above), change strcpy usage to strncpy.

	* libopenvas/www_funcs.c: (build_encode_URL) Change strcpy usage to
	strncpy, change sprintf usage to snprintf, ignore snprintf warnings
	(see above), ignore lrand48 warnings (see above).

	* libopenvas/rand.c (nessus_init_random, lrand48, srand48): Ignore
	warnings about insufficient randomness.

	* libopenvas/ftp_funcs.c (ftp_log_in): Changed remaining sprintf usage
	to snprintf, ignore snprintf warnings (see above).

	* libopenvas/store.c: (arglist2str, store_load_plugin, store_plugin,
	store_get_plugin_f) Change strcat usage to strncat; ignore RATS
	warnings regarding strncat since sufficient memory is allocate before
	strncat usage. (safe_copy, store_plugin) Change ignore flag to RATS.
	(store_init_sys, store_init_user, store_get_plugin_f,
	store_load_plugin, store_plugin) Ignore snprintf warnings (see above).

2008-12-03  Michael Wiegand <michael.wiegand@intevation.de>

	Implementing CR #22 (New script_tag Command,
	http://www.openvas.org/openvas-cr-22.html).

	* libopenvas/plugutils.c: Added plug_set_tag, plug_get_tag and
	_plug_get_tag functions.

	* libopenvas/store_internal.h: Added tag field to struct, incremented
	magic number, updated function declarations.

	* libopenvas/plugutils.h: Updated function declarations.

	* libopenvas/store.c: Added store_fetch_tag function. (store_plugin)
	Added support for script_tag.

2008-11-18  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated.

2008-11-18  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/share_fd.c: Re-added missing include that resulted in
	recv_fd failing due to missing defines.

2008-11-18  Michael Wiegand <michael.wiegand@intevation.de>

	Fixing version requirements for glib as pointed out by atomicturtle.

	* configure.in: Updated glib requirements to >= 2.6.0

	* configure: Regenerated.

2008-11-17  Matthew Mundell <matt@mundell.ukfsn.org>

	* libopenvas/network.c (ovas_get_tlssession_from_connection): Return
	address instead of value, to match return type.
	(open_SSL_connection): Check errno for EINTR and EAGAIN after
	gnutls_handshake.
	(ovas_server_context_attach): Retry gnutls_handshake if necessary.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta3.SVN.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Preparing the 2.0-beta2 release.

	* VERSION: Set to 2.0.0.beta2.

	* MANIFEST: Updated.

	* CHANGES: Updated.

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	* openvas-libraries.tmpl.in: Added datarootdir to remove configure
	warning and to be compatible with autoconf 2.60 (see
	http://www.gnu.org/software/libtool/manual/autoconf/Changed-Directory-Variables.html).

2008-11-14  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros.

	* libopenvas/arglists.c (arg_dump): Minor reformattings, added cast to
	avoid fprintf format string warning.

2008-11-13  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Narrowed down space for fingerprints in servers cache.

	Attention: Server cache has to be rebuilt!
	(remove  .desc in plugin directory)

	* libopenvas/store_internal.h : Decreased fingerprint array size.

	* ChangeLog : Email typo fixed.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	Applying patch provided by Stjepan Gros to improve 64-bit cleanliness.

	* configure.in: Added check for the glib2 library.

	* configure: Regenerated.

	* aclocal.m4: Regenerated.

	* libopenvas/harglists.c, libopenvas/arglists.c,
	libopenvas/plugutils.c, libopenvas/network.c,
	libopenvas/Makefile, libopenvas/store.c,
	libopenvas/scanners_utils.c, libopenvas/kb.c,
	openvas-libraries.tmpl.in: Introduced glib library.

	* libopenvas/harglists.c, libopenvas/harglists.h,
	libopenvas/arglists.c, libopenvas/plugutils.c,
	libopenvas/network.c, libopenvas/scanners_utils.c,
	libopenvas/kb.c, libopenvas/store.c: 32/64-bit cleanup.

	* libopenvas/plugutils.c: Minor reformatings.

2008-11-12  Michael Wiegand <michael.wiegand@intevation.de>

	* configure.in: Added AC_PREREQ directive to tell autoconf to generate
	a 2.50-style configure script.

2008-11-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c (ovas_get_connection_data): Renamed to
	ovas_get_tlssession_from_connection and made it return the
	tls session directly instead of connection data.
	This way it is avoided to expose the internal data
	structure "nessus_connection". It remains internal now.

	* libopenvas/network.h: Updated proto accordingly and added
	include for now-necessary gnutls.h.

2008-11-11  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store.c (store_load_plugin): Fixed usage of legacy ID
	scheme that resulted in an incorrect OID being transmitted to the client
	when processing NVTs without any legacy ID.

2008-11-10  Michael Wiegand <michael.wiegand@intevation.de>

	Removed local copies of getopt; the functionality provided by getopt has
	been replaced with glib as explained in Change Request #9
	(http://www.openvas.org/openvas-cr-9.html).

	* include/config.h.in: Removed obsolete defines for getopt.

	* configure.in: Removed obsolete checks for getopt.

	* configure: Regenerated.

	* libopenvas/getopt.c, libopenvas/getopt.h, libopenvas/getopt1.c:
	Removed obsolete local copies of getopt.

	* libopenvas/Makefile: Removed handling of getopt files.

	* TODO: Removed section regarding getopt copies.

	* MANIFEST: Updated.

	* Makefile: Removed handling of getopt files.

2008-11-07  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/network.c, libopenvas/network.h: Added
	ovas_get_connection_data function provided by Matthew Mundell as
	support for the upcoming OpenVAS Management functionality.

2008-11-06  Michael Wiegand <michael.wiegand@intevation.de>

	* INSTALL_README: Updated note regarding gnutls version requirements as
	pointed out by Toan Nguyen.

2008-11-05  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Work on Change Request #17 (http://www.openvas.org/openvas-cr-17.html -
	"OTP: Make NVT signatures available to OpenVAS-Client").
	Replaced sending of dummy certificate key oids by "real" fingerprints.

	* libopenvas/store.c (store_load_plugin): Fixed tests about signature
	file, replaced obsolete ID check by OID check, removed dummy string.

2008-10-31  Felix Wolfsteller <felix.wolfsteller@intevation.de>

	Steps to an implementation of Change Request #17
	(http://www.openvas.org/openvas-cr-17.html - "Make NVT signatures
	available to OpenVAS-Client").
	Adds the new field "sign_key_ids" to plugin-structures and the .desc
	store. Until soon, just a dummy- string will be saved and eventually
	transmitted by the server.

	IMPORTANT: Breaks compatibility and renders old server .desc- cache
	files useless.

	* libopenvas/plugutils.c (plug_set_sign_key_ids, plug_get_sign_key_ids):
	Added getter & setter to retrieve key-ids of certificates of a plugin.

	* libopenvas/plugutils.h: Prototypes for plug_set_sign_key_ids and
	plug_get_sign_key_ids added.

	* libopenvas/store_internal.h: Added sign_key_ids field to plugin struct
	 and increased magic number for server-side cache (.desc files)

	* libopenvas/store.c (store_init_sys, store_init_user): Added comments.

	* libopenvas/store.c (store_load_plugin): Check if signature file
	is new than cache (functionality will be moved), set sign_key_ids
	according to cache, added comments.

	* libopenvas/store.c (store_plugin): Stores the (dummy) key_id- string.

2008-10-12  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated.

	* packaging/debian/copyright: Updated.

	* packaging/debian/rules: Cleaned up.

	* packaging/debian/libopenvas2-dev.dirs,
	packaging/debian/libopenvas2-dev.install,
	packaging/debian/libopenvas2.dirs,
	packaging/debian/libopenvas2.install: Added.

2008-10-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/pcap.c: Added missing include for config.h; this fixes a
	bug caused by a missing #define that led to a segfault on 64bit
	machines and was discovered by Michael Meyer.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: Removed elements "scan_ids",
	"dns" and "pubkey_auth" from struct ntp_caps.

	* libopenvas/scanners_utils.c (comm_send_status): Removed
	unneeded variable declaration.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: Removed elements "md5_caching",
	"ntp_11", "plugins_oid", and "plugins_version" from
	struct ntp_caps.

2008-09-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/scanners_utils.c(comm_send_status): Removed
	conditional for ntp_11, because this is standard for otp.

	* libopenvas/plugutils.c (scanner_add_port): Removed
	conditional for ntp_11, because this is standard for otp.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Post release version bump.

	* VERSION: Set to 2.0.0.beta2.SVN.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Last minute fix to MANIFEST for 2.0-beta1.

	* MANIFEST: Updated.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 2.0-beta1 release.

	* VERSION: Set to 2.0.0.beta1.

	* CHANGES: Updated.

2008-09-23  Michael Wiegand <michael.wiegand@intevation.de>

	Fixed uses of sprintf in libopenvas/plugutils.c that could lead to
	buffer overflows under certain circumstances. Told RATS and flawfinder
	to ignore the use of snprintf; we will assume that glibc provides us
	with an up-to-date snprintf. Changed "flawfinder" ignore statements to
	"RATS" since the "RATS" keyword is supported by both RATS and
	flawfinder.

	* libopenvas/plugutils.c (plug_set_id, _add_plugin_preference,
	plug_set_replace_key): Replaced sprintf usage with snprintf.

2008-09-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c (proto_post_wrapped): escape_crlf is
	now standard with OTP 1.0.
	Removed unused variables caps and t.

	* libopenvas/ntp.h: Removed elements "plugins_xrefs",
	"plugins_bugtraq_id", "md5_by_name", "fast_login",
	"dependencies", "plugins_cve_id", "ciphered", "escape_crlf"
	and "timestamps" from struct ntp_caps.
	Removed defines for NTP_10, NTP_11 and NTP_12.

2008-09-19  Michael Wiegand <michael.wiegand@intevation.de>

	Added support for new LOG and DEBUG messages.

	* libopenvas/plugutils.c (proto_post_log, post_log, post_log_udp,
	proto_post_debug, post_debug, post_debug_udp): Added functions to
	support new LOG and DEBUG messages.

	* libopenvas/plugutils.h: Added function declarations for new functions.

2008-09-16  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (plug_get_oid): Do not use cached OIDs, use
	_plug_get_oid instead of store_fetch_oid; otherwise plug_get_oid will
	return wrong OIDs under certain circumstances, which breaks qsort among
	others.

2008-09-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (mark_successful_plugin, mark_post): Use OIDs
	instead of IDs for logging messages and plugin success in KB.

2008-09-09  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/plugutils.c (proto_post_wrapped): Use OIDs instead of IDs,
	removed obsolete code.

2008-09-02  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/network.c (ovas_server_context_attach): Display gnutls
	error messages only when DEBUG_SSL is defined.

2008-08-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.h: Added an explicit include.

2008-08-21   Vlatko Kosturjak <kost@linux.hr>

	* libopenvas/plugutils.c (plug_set_id): Display "Legacy detected plugin"
	only if DEBUG is defined

2008-07-31  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/plugutils.c: Fixed duplicate declaration of oldid.

	* libopenvas/ntp.h: Added definition for ONTP/1.3.

2008-07-30  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/pcap.c (getinterfaces): Added a FIXME reminder about
	bad programming style with potential of runtime failires as
	reported by Hanno Bck in order to not forget about this problem.

2008-07-18  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/plugutils.c, libopenvas/plugutils.h: Added additional
	checks to plug_set_id and plug_set_oid functions, so that setting
	an OID can not override an a legacy ID. Moreover, setting a legacy
	ID implictly sets a legacy OID.

2008-07-08  Tim Brown <timb@nth-dimension.org.uk>

	* ChangeLog, openvas-libraries/libopenvas/store_internal.h,
	packaging/debian/changelog: Fix typos.

2008-07-07  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog: Set
	openvas-distro-deb@wald.intevation.org as Debian Maintainer.

	* packaging/debian/changelog, packaging/debian/copyright,
	packaging/debian/rules: Remove trailing witespaces at EOL and EOF.

	* packaging/debian/changelog, packaging/debian/control:
	Move Section to right place for openvas-libraries in control.

	* packaging/debian/changelog, packaging/debian/control:
	Also depend on libgnutls-dev, libpcap-dev for -dev.

	* packaging/debian/changelog, packaging/debian/libopenvas1.dirs,
	packaging/debian/libopenvas1-dev.dirs: Remove debian/*.dirs since
	unneeded.

2008-07-04  Jan Wagner <waja@cyconet.org>

	* packaging/debian/changelog, packaging/debian/control:
	New debian package version with some minor changes.
	Set openvas-distro-debian@wald.intevation.org as Debian Maintainer.

2008-07-04  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas_hg/hg_dns_axfr.c (hg_dns_axfr_add_host)
	(hg_dns_read_ns_from_answer, hg_dns_axfr_query): Replaced ns_get16
	with local copies taken from glibc as ns_get16 proved to be not very
	portable either and led to problems in the build process for RPMs.

2008-06-30  Michael Wiegand <michael.wiegand@intevation.de>

	Post-release version bump.

	* VERSION: Set to 1.0.3.SVN.

2008-06-30  Michael Wiegand <michael.wiegand@intevation.de>

	Doing the 1.0.2 release.

	* VERSION: Set to 1.0.2.

	* CHANGES: Updated.

2008-06-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas-config.in: Fix variable replacement problems.
	Original problem report and initial patch supplied by
	Ales Nosek.

2008-06-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Simplify handling of libopenvas-config: The two-step
	method is not necessary.

	* libopenvas-config.pre.in: Removed. Renamed to
	libopenvas-config.in.

	* libopenvas-config.in: New. Former libopenvas-config.pre.in.

	* configure.in: Process libopenvas-config.in instead of
	libopenvas-config.pre.in.

	* Makefile: Removed any processing of libopenvas-config.

	* configure: Updated.

	* MANIFEST: Updated.

2008-06-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing handling of "CIPHER" information because
	the client-server communication is always encrypted.

	* configure.in: Removed handling of "cipher_cflags"
	and "use_cipher". This means the option --enable-cipher
	is not available anymore.

	* libopenvas-config.pre.in: Removed handling of CIPHER and
	CIPHER_CFLAGS.

	* openvas-libraries.tmpl.in: Removed handling of
	USE_CIPHER and CIPHER_CFLAGS.

	* INSTALL_README: only slightly improved. Now does
	not mention anymore --enable-cipher option.

	* configure: Updated.

2008-06-20  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/hlst.c (sort_hlst): Avoid sorting an hlst if it has no
	entries since that will lead to an emalloc issue under certain
	conditions.

2008-06-12  Michael Wiegand <michael.wiegand@intevation.de>

	* libopenvas/store_internal.h: Increased MAGIC number to reflect
	changes as suggested by Bernhard Herzog. Deleting
	/lib/openvas/plugins/.desc/* is no longer neccessary.

2008-06-12  Michael Wiegand <michael.wiegand@intevation.de>

	Increased the space available to plugins for preferences
	storage. This resolves an issue with plugins with a large
	number of radio button options, as they need to store the
	text for all options in the name field.

	IMPORTANT: You need to delete the server plugin cache in
	/lib/openvas/plugins/.desc/* to force the server to create
	a new cache after compiling with this change. Otherwise the
	server will send wrong plugin information to the client,
	resulting in missing options in the preferences.

	* libopenvas/store_internal.h: Increased size of name field
	in pprefs struct to allow for plugins with many preferences.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store_internal.h: Increased MAGIC number, lowered size
	of oid vom 1024 bytes to 100.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ntp.h: New. Contains the definition for ntp_caps (taken
	from comm.h) and the makros for NTP protocol IDs (taken
	from ntp.h of package openvas-server)

	* libopenvas/comm.h: Removed definition of ntp_caps and cleaned up.

	* Makefile: Install ntp.h as well.

	* MANIFEST: Updated.

2008-05-06  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/nessus-devel.h: Removed. It wasn't included anywhere in OpenVAS.

	* MANIFEST: Updated.

2008-05-02  Javier Fernndez-Sanguino Pea <jfs@computer.org>

	* libopenvas/Makefile, libopenvas_hg/Makefile, openvas-libraries.tmpl.in:
	Fix the build process to get the libraries to include
	their linked libraries.

	* packaging/debian/control, packaging/debian/changelog: New package
	version, fixing build-dep

2008-05-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/Makefile: Fixed all dependencies on header files. Removed
	non-existing module "ptycall".

	* libopenvas/kb.c: Fixed include method.

	* libopenvas/store_internal.h: Added missing proto for store_fetch_oid()

2008-04-30  Tim Brown <timb@nth-dimension.org.uk>

	* libopenvas/comm.h, libopenvas/plugutils.c, libopenvas/store_internal.h,
	libopenvas/plugutils.h, libopenvas/plugutils_internal.h,
	libopenvas/store.c: Preliminary support for script_oid function.

	* packaging/debian/control, packaging/debian/copyright: Minor updates to
	control and copyright file to fix issues highlighted by jfs in regard to
	the priority and copyright of the packaging respectively.

	* packaging/debian/control: Minor update to control to fix differing
	dependency between openvas-libraries and openvas-libnasl as
	highlighted by jfs.

2008-04-18  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging/fedora: New. Directory for Fedora RPM files.

	* fedora/openvas-libraries-1.0.1-1.fc8.openvas.spec,
	fedora/openvas-libraries-1.0.1-hg-Makefile.diff
	fedora/openvas-libraries-1.0.1-Makefile.diff: New.

	* MANIFEST.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* packaging/opensuse: New. Directory for OpenSUSE RPM files.

	* packaging/opensuse/openvas-libraries-1.0.1-1.suse102.openvas.spec,
	packaging/opensuse/openvas-libraries-1.0.1-Makefile.diff,
	packaging/opensuse/openvas-libraries-1.0.1-hg-Makefile.diff: New.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c (open_socket): Fixed makro name for SSL debugging
	and thus reactived code execute for debug-ssl mode.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile, libopenvas_hg/Makefile: Add missing DESTDIR for install
	targets.

2008-04-16  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* INSTALL_README: Remove note about bison as it is not needed anymore.

2008-04-16  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor fixes, now lintian clean.

2008-04-02  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/changelog: Updated for new upstream release

2008-04-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: post-release version bump to 1.0.2.SVN

2008-04-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 1.0.1.

	* VERSION: Set to 1.0.1.

	* CHANGES: Updated.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added item about Makefile improvements.

	* MANIFEST: Fixed.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Removed various declarations
	that do not appear anywhere else in OpenVAS.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Moved some declarations for module plugutils
	to libopenvas/plugutils.h.

	* libopenvas/plugutils.h: Added some declarations from
	include/libopenvas.h.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/services.c, libopenvas/network.c: Removed
	"ExtFunc" declarations.

2008-03-27  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Removed Windows-Specific ifdef's.

	* include/includes.h: Removed "ExtFunc".

	* TODO: Changed entry about include/includes.h

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/getopt1.c: Add inclusion of config.h
	to have openvas-libnasl compile again.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/popen.h: Fixed proto.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/kb.h, libopenvas/store.h,
	libopenvas/services1.h, libopenvas/system.h,
	libopenvas/plugutils.h, libopenvas/arglists.h,
	libopenvas/network.h, libopenvas/bpf_share.h,
	libopenvas/share_fd.h, libopenvas/pcap_openvas.h,
	libopenvas/popen.h, libopenvas/www_funcs.h:
	Changed Author and Copyright to the contents of
	include/libopenvas.h which is the origin of most
	of the contents of the new header files.

2008-03-26  Tim Brown <timb@nth-dimension.org.uk>

	* configure.in: Fix up resolv checks as dn_expand is only
	a weak alias to __dn_expand. resolv.h #define's it but
	autoconf never #includes that when making the check.

	* configure: Updated.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Fix up some includes.

	* Makefile: Don't install includes.h, no one external
	should be in need of this.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/getopt.c: Replaced inclusion of includes.h
	by config.h which appears sufficient.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/getopt.h: Moved to libopenvas/

	* libopenvas/getopt.h: New. Previous include/getopt.h.

	* libopenvas/getopt1.c: Removed includes.h and adapted
	according to move of getopt.h

	* MANIFEST: Updated.

	* Makefile: Reflected location change of getopt.h.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/ids_send.c: Removed inclusion of includes.h
	and added FIX() definition from there.

2008-03-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/hlst.c: replace inlusion of "includes.h" by
	respective single includes.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Made openvas-libraries compile after a "make clean".

	* include/libopenvas.h: Moved various defines to
	libopenvas/ids_send.h.

	* libopenvas/ids_send.h: Added some defines moved
	from libopenvas.h.

	* libopenvas/plugutils.c: Added missing include.

	* libopenvas/network.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/ids_send.c: replace inlusion of "includes.h" by
	respective single includes except that includes.h
	remains were it is for a missing define ("FIX()").
	Removed ExtFunc.

	* libopenvas/ftp_funcs.h: Added missing include.

	* TODO: Removed resolved entry.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module store.

	* libopenvas/store.c: replace inlusion of "includes.h" by
	respective single includes. Replaced PATH_MAX by MAXPATHLEN.

	* libopenvas/store.h: New. Contains declarations
	for module "store" (extracted from libopenvas.h)

	* include/libopenvas.h: Removed declarations for store
	and replaced by include of store.h.

	* Makefile: Install libopenvas/store.h.

	* MANIFEST: Updated.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/store.h: Renamed to store_internal.h.

	* libopenvas/store_internal.h: New. Former store.h.

	* libopenvas/plugutils.c: Reflect renaming of store.h to
	store_internal.h.

	* libopenvas/store.c: Reflect renaming of store.h to
	store_internal.h and added missing includes.

	* MANIFEST: Updated.

2008-03-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module share_fd.

	* libopenvas/share_fd.c: removed inlusion of "includes.h".

	* libopenvas/share_fd.h: New. Contains declarations
	for module "share_fd" (extracted from libopenvas.h)

	* include/libopenvas.h: Removed declarations for share_fd
	and replaced by include of share_fd.

	* Makefile: Install libopenvas/share_fd.h.

	* MANIFEST: Updated.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for modules services and services1.

	* libopenvas/services.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/services1.c: replace inlusion of "includes.h" by
	respective single includes.

	* libopenvas/services1.h: New. Contains declarations
	for module "services1" (extracted from libopenvas.h)

	* libopenvas/services.h: Moved declarations of services1 to
	services1.h.

	* include/libopenvas.h: Removed declarations for services1
	and replaced by include of services1.

	* include/popen.h: Added missing include for stdio.h.

	* Makefile: Install libopenvas/services1.h.

	* MANIFEST: Updated.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module scanners_utils.

	* libopenvas/scanners_utils.c: replace inlusion of "includes.h" by
	respective single includes. Removed ExtFunc.

	* include/libopenvas.h: Removed declarations for scanners_utils
	and replaced by include of scanners_utils.

	* include/comm.h: Added missing include for arglists.h.

	* Makefile: Install libopenvas/scanners_utils.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module rand.

	* libopenvas/rand.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Removed declarations for rand
	and replaced by include of proctitle.

	* Makefile: Install libopenvas/rand.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module proctitle.

	* libopenvas/proctitle.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Removed declarations for proctitle
	and replaced by include of proctitle. The declarations were
	not identical but similar enough.

	* Makefile: Install libopenvas/proctitle.h.

2008-03-23  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/scanners_utils.c (qsort_compar): Made static.

2008-03-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module popen.

	* libopenvas/popen.h: New. Contains declarations
	for module "popen" (extracted from libopenvas.h)

	* libopenvas/popen.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any popen declarations
	to popen.h.

	* libopenvas/scanner_utils.h: Added missing include.

	* Makefile: Install libopenvas/popen.h.

	* MANIFEST: Updated.

2008-03-22  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module www_funcs.

	* libopenvas/www_funcs.h: New. Contains declarations
	for module "www_funcs" (extracted from libopenvas.h)

	* libopenvas/www_funcs.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any www_funcs declarations
	to www_funcs.h.

	* libopenvas/plugutils.h: Added missing include.

	* Makefile: Install libopenvas/plugutils.h.

	* MANIFEST: Updated.

2008-03-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module plugutils.

	* libopenvas/plugutils.h: New. Contains declarations
	for module "plugutils" (extracted from libopenvas.h)

	* libopenvas/plugutils.c: replace inlusion of "includes.h" by
	respective single includes. Removed "ExtFunc".

	* include/libopenvas.h: Moved any plugutils declarations
	to plugutils.h.

	* libopenvas/comm.h, libopenvas/services.h,
	libopenvas/scanners_utils.h: Remove "ExtFunc" declaration.

	* Makefile: Install libopenvas/plugutils.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.h: Renamed to plugutils_internal.h.

	* libopenvas/plugutils_internal.h: New. Former plugutils.h.

	* libopenvas/store.c: Reflect renaming of plugutils.h to
	plugutils_internal.h.
	(store_get_plugin_f): Made static.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module system.

	* libopenvas/system.h: New. Contains declarations
	for module "system" (extracted from libopenvas.h)

	* libopenvas/system.c: replace inlusion of "includes.h" by
	respective single includes. Removed empty "ExtFunc".

	* include/libopenvas.h: Moved any system declarations
	to system.h.

	* Makefile: Install libopenvas/system.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.h: Renamed to system_internal.h

	* libopenvas/system_internal.h: New. Previous system.h.

	* libopenvas/harglists.c, libopenvas/pcap.c,
	libopenvas/system.c, libopenvas/arglists.c,
	libopenvas/Makefile, libopenvas/kb.c,
	MANIFEST: Reflect name change from
	system.h to system_internal.h.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module pcap.

	* libopenvas/pcap_openvas.h: New. Contains declarations
	for module "pcap_openvas" (extracted from libopenvas.h)

	* libopenvas/pcap.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any pcap declarations
	to pcap_openvas.h.

	* Makefile: Install libopenvas/pcap_openvas.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module kb.

	* libopenvas/kb.h: New. Contains declarations
	for module "kb" (extracted from libopenvas.h)

	* libopenvas/kb.c: replace inlusion of "includes.h" by
	respective single includes.

	* include/libopenvas.h: Moved any kb declarations
	to kb.h.

	* Makefile: Install libopenvas/kb.h.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/harglists.h: Removed. Moved to libopenvas/harglists.h.

	* libopenvas/harglists.h: New. Former include/harglists.h.

	* Makefile: Reflect move of harglists.h.

	* libopenvas/harglists.c: replace inlusion of "includes.h"
	separate ones for the only needed declarations.

	* MANIFEST: Updated.

2008-03-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas_hg/Makefile: Added path to libopenvas/ for
	include files. This make the library to build again.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Cleanup for module bpf_share.

	* libopenvas/bpf_share.h: New. Contains declarations
	for module "bpf_share". (extracted from libopenvas.h and removed
	ExtFunc while we are at it)

	* libopenvas/bpf_share.c: replace inlusion of "includes.h" by
	"pcap.h" which is already sufficient.

	* include/libopenvas.h: Moved any bpf_share declarations
	to bpf_share.h.

	* Makefile: Install libopenvas/bpf_share.h.

	* MANIFEST: Updated.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Implementing OpenVAS Change Request #5: Remove BPF sharing feature

	* configure.in: Remove option "--enable-bpf-sharing" and adapt
	corresponding messages.

	* configure: updated.

	* README.BPF: Renamed Nessus to OpenVAS, added note that there
	once was a feature for bpf-sharing.

	* libopenvas/bpf_share.c: Removed the whole alternative
	block for "HAVE_DEV_BPFN".
	(main): Also removed the now useless=empty test frame.

	* libopenvas/Makefile: bpf_sharing does not need to know
	about the StateDir anymore.

	* TODO: Removed entry about BPF sharing.

2008-03-17  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added entry describing how the cleanup re header files
	should be continued.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.h: New. Contains external header information
	for module "network". (extracted from libopenvas.h)

	* libopenvas/ftp_funcs.h: Updated header for OpenVAS, removed
	"ExtFunc".

	* libopenvas/ftp_funcs.c: Updated header for OpenVASremoved "ExtFunc",
	replaced includes.h by actually required includes.

	* include/libopenvas.h: Moved any ftp_funcs declarations
	to ftp_funcs.h. Moved most network declarations to network.h.

	* Makefile: Install libopenvas/network.h and libopenvas/ftp_funcs.h.

	* libopenvas/arglists.h: Added forgotten ifdef.

	* MANIFEST: Updated.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing unsused module "data". It was meant as a future
	replacement of arglists. However, it does only try the same
	philosophy with some improvments whereas it makes more
	sense to leave optimized handling to specialists like glib.

	* libopenvas/data.c, include/data.h: Removed.

	* TODO: Removed enty about data.c.

	* MANIFEST: updated.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	A sample cleanup for header files.

	* libopenvas/arglists.h: New. Contains external header information
	for module "arglists". (extracted from libopenvas.h)

	* Makefile: Install libopenvas/arglists.h.

	* include/libopenvas.h: Converted header block to standard one.
	Removed any arglists definitions and instead includes arglists.h.

	* libopenvas/arglists.c: Replace generic include of includes.h
	by respective required single include statements.
	Removed any use of "ExtFunc" declaration which is empty anyway.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c: Removed include for diff.h.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* include/libopenvas.h: Annotated module names, some lines reordered,
	removed W32 conditional.

2008-03-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Added entry about data.c

2008-03-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/Makefile: Removed handling of module "diff".

	* libopenvas/diff.c, libopenvas/diff.h: Removed as the
	only method "banner_diff" isn't used anywhere in OpenVAS.

	* MANIFEST: updated.

2008-03-10  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing the apparently unused module "snprintf". There exists
	no corresponding proto and thus it could never be used without
	occuring warnings during compilation. snprintf is part of C99.

	* libopenvas/Makefile: Remove handling of snprintf module.

	* MANIFEST: Updated.

	* libopenvas/snprintf.c: Removed.

2008-03-03  Laban Mwangi <labeneator@gmail.com>

	* libopenvas/plugutils.c, libopenvas/proctitle.c,
	libopenvas/store.c, libopenvas/www_funcs.c:
	Adding FlawFinder ignores to various string operations
	as discussed on the Mailing List.

2008-02-16  Laban Mwangi <labeneator@gmail.com>

	* libopenvas/hlst.c (flush_hlst, make_hlst, sort_hlst, unsort_hlst),
	libopenvas/hlst.h (_hlst): Fixing flawfinder l4 warnings
	related to flawfinder thinking that a ptr in a linkedlist called
	access is = the call access(2)

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/store.c (safe_copy): Cast return value strlen to
	match format string.  Silences a compiler warning

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/www_funcs.c (http11_get_head): Removed this unused
	function.  Silences a compiler warning.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas_hg/hg_dns_axfr.c (hg_dns_axfr_add_host)
	(hg_dns_read_ns_from_answer, hg_dns_axfr_query): Use ns_get16
	instead of _getshort.  _getshort is defined in glibc but not
	declared in any headerfile.  ns_get16 is a newer API but should be
	widely available, too.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/hlst.c (copy_hlst): Fix Flawfinder issue.

2008-02-15  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/harglists.c (say_creating): Fix format string to
	match the types that will actually be used
	(say_closing, message): Fix Flawfinder issues
	(do_printf): Fix flawfinder issues.  Fix gcc warnings about
	fprintf args, adapting a format string to better match the purpose
	of printing the value of a pointer.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removal of Flawfinder issues.

	* libopenvas/system.c (emalloc): replace usleep() by nanosleep().
	(estrdup): Set two Flawfinder: ignore, one reported path can not
	happen (now documented) and whether to use strlen() is a more general
	question.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.c, libopenvas/system.h: Applied standard header,
	added comments on unclear things.

2008-02-15  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/system.c (emalloc, erealloc): Added type cast to get rid of
	compiler warning.

2008-02-12  Laban Mwangi <labeneator@gmail.com>

	* INSTALL_README: Added dependent libraries (bug
	fix for aid #591)

2008-02-12  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor fixes, now includes scripts to
	allow dependents to build. Also fixed minor typo in
	packaging/debian/copyright.

2008-02-05  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/*: Minor changes, now builds lintian clean.
	* packaging/debian/copyright: More information in the copyright,
	including a detailed account of holders.

2007-11-07  Tim Brown <timb@nth-dimension.org.uk>

	* packaging/debian/control, packaging/debian/copyright: Minor
	changes to fix Homepage and Copyright directives.

2007-10-31  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: Updated.

2007-10-31  Tim Brown <timb@nth-dimension.org.uk>

	* packaging, packaging/debian: New directories.

	* packaging/debian/control, packaging/debian/libopenvas.dirs,
	packaging/debian/compat, packaging/debian/libopenvas-dev.install,
	packaging/debian/changelog, packaging/debian/libopenvas.install,
	packaging/debian/copyright, packaging/debian/rules,
	packaging/debian/libopenvas-dev.dirs: New. The debian packaging files.

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: post-release version bump to 1.0.1.SVN

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: Updated.

2007-10-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 1.0.0.

	* VERSION: Set to 1.0.0.

	* CHANGES: Updated.

2007-10-11  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* README.HPUX: Removed. This information seem to be a leftover
	from stoneage time.

	* TODO: More things noted.

2007-10-08  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Some code cleanups.

	* libopenvas/plugutils(plug_get_fresh_key): Fixed wrong number of
	arguments for fprintf call.

	* libopenvas/harglists.c(harg_addt, harg_set_valuet, harg_renamet): Add
	more ()s to make clear && is to be evaluated before ||. This was
	suggested by gcc.

	* libopenvas/www_funcs.c(http_get, http_head, httpver, http10_head, http10_get,
	http10_get_head, http11_head, http11_get): Removed. These functions have never been used.

2007-10-08  Bernhard Herzog  <bh@intevation.de>

	* libopenvas_hg/Makefile: Install hosts_gatherer.h and hg_utils.h
	into ${includedir}/openvas.  They contain declarations needed by
	openvas-server and openvas-libnasl

2007-09-25 Tim Brown <timb@nth-dimension.org.uk>

	Patch to fix two "implicit declaration" gcc-warnings submitted
	by Hanno Bck on openvas-devel.

	* include/includes.h: Add include of fnmatch.h.

	* include/libopenvas.h: Added proto for kb_item_rm_all().

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: bumped to 0.9.2.SVN

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 0.9.1.

	* VERSION: Set to 0.9.1.

	* CHANGES: Updated.

2007-09-13  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: Removed the entry about separate versioning (it is
	done now). Also removed the entry about reviewing the Debian patches
	to nessus-libraries (done).

	* libopenvas/bpf_share.c, libopenvas/services.h: Fixed paths to
	state dir to LFSH standard. This make the current Debian patch
	to the according Makefile in nessus-libraries unnecessary.

2007-08-03  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, openvas-libraries.tmpl.in, include/libvers.h.in,
	libopenvas/plugutils.c: Replaced NESSUS_MAJOR etc. by
	OPENVASLIBS_MAJOR etc. as well as NL_MAJOR etc. by
	OPENVASLIBS_MAJOR etc.

	* configure: updated.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c, libopenvas/scanners_utils.c,
	libopenvas/store.c: Removed unused variables.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas_hg/Makefile: Fix dependencies for target test.

	* libopenvas_hg/hosts_gatherer.h: Add missing proto
	for hg_test_syntax().

	* libopenvas_hg/test.c (main): Fix return type.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: bumped to 0.9.1.SVN

	* CHANGES: updated.

	* libopenvas_hg/hg_dns_axfr.c: Removed CYGWIN
	part which was not implemented anyway (just a stub).

	* libopenvas/getopt1.c, libopenvas/getopt.c,
	libopenvas/harglists.c, libopenvas/hlst.c: Removed
	handling of _WIN32.

	* Makefile: Removed target win32.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libhosts_gatherer, libopenvas_hg: renamed
	libhosts_gatherer to libopenvas_hg.

	* Makefile: renamed libhosts_gatherer to libopenvas_hg.

	* MANIFEST: updated.

2007-08-02  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas-config.pre.in, libhosts_gatherer/Makefile,
	libhosts_gatherer/test.c: Renamed libhost_gatherer
	by libopenvas_hg.

2007-08-01  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed strange handling of CWARN which tries to collect
	a number of warning wishes for compilation. It didn't
	really work anyway.
	Replaced this by: allways give all warnings (-Wall).

	* configure.in, openvas-libraries.tmpl.in: Removed handling
	of CWARN[01234] and CWALL.

	* configure: updated.

	* libopenvas/Makefile, libhosts_gatherer/Makefile: Added
	-Wall as compile flag.

2007-07-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* CHANGES: Set release date to 27.7.2007

2007-07-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Doing the release 0.9.0.

	* VERSION: Set to 0.9.0.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/proctitle.c (setproctitle):
	Change name of daemon from nessusd to openvasd.

	* include/config.h.in: Removed NESSUSD_USERNAME which is not
	used anywhere.

	* libopenvas/services.h: Changed paths from nessus to openvas.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: replaced AC_HAVE_LIBRARY by AC_CHECK_LIB for
	gnutls, resolve and pcap and emit error when not found.
	Also replaced the not-so-helpful message after running
	configure with some more useful.

	* configure: updated.

	* libopenvas/Makefile: Fixed dependencies reg. network.h.

2007-07-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* MANIFEST: updated.

2007-07-25  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.h: Removed. Everything declared in network.h
	is also declared in libopenvas.h

	* libopenvas/pcap.c, libopenvas/network.c, libopenvas/ids_send.c:
	Remove includes of network.h

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (ovas_server_context_attach)
	(read_stream_connection_unbuffered)
	(write_stream_connection4, internal_send, internal_recv): Remove
	unused variables

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c: Add missing include of <gnutls/x509.h>

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (verify_peer_certificate): Make status an
	unsigned int so that it matches the signature of
	gnutls_certificate_verify_peers2

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (set_gnutls_priorities)
	(set_gnutls_protocol): Renamed set_gnutls_priorities to
	set_gnutls_protocol
	(open_SSL_connection, ovas_server_context_attach): Updated because
	of set_gnutls_priorities renaming
	(set_gnutls_priorities): New function that sets the priorities of
	a session from a bunch of int arrays and handles errors
	(set_gnutls_sslv23, set_gnutls_sslv3, set_gnutls_tlsv1): Use
	set_gnutls_priorities to set the priorities instead of calling the
	gnutls functions directly.  Also return an error code properly.

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Return a value (0) if
	already initialized

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Make sure
	gnutls_global_init is only called once even if nessus_SSL_init is
	called multiple times.

2007-07-24  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (load_file, unload_file): Use emalloc and
	efree to be consistent with the rest of the libopenvas code

2007-07-20  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/services.h: Fixed location of openvas-services.

2007-07-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvas-libraries.tmpl.in: Removed remains for libcap-nessus
	and PCAP_-variables

2007-07-19  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	First preparations for release.

	* include/libopenvas.h, include/config.h.in: Removed last occurances of HAVE_SSL.

	* MANIFEST: updated.

	* CHANGES: New. Describes Changes for users.

	* Makefile: No sbin required for installation of this package.

	* TODO: Removed item about libpcap which indeed has been removed
	meanwhile.

	* INSTALL_README: Added a warning that these instructions might
	not be uptodate.

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* include/includes.h: Remove openssl includes

2007-07-18  Bernhard Herzog  <bh@intevation.de>

	* include/libopenvas.h: Removed the declaration of
	nessus_register_connection that uses a SSL* as the second
	parameter.  The void* variant is still there.

2007-07-17  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.h, include/libopenvas.h: Remove declarations
	of unused and unimplemented functions:
	   stream_get_server_certificate
	   stream_get_ascii_server_certificate

2007-07-17  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_install_passwd_cb, sslerror)
	(sslerror2): Removed.  They are no longer used anywhere.
	(stream_get_ssl): Change the return type to void* so that we no
	longer need openssl.h

	* include/libopenvas.h: Remove declaration of
	nessus_install_passwd_cb and sslerror.  Update declaration of
	stream_get_ssl

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (verify_peer_certificate): If the peer
	did not send a certificate, treat it as valid.

2007-07-02  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (OVAS_CONNECTION_FROM_FD): New. Macro to
	determine the nessus_connection* given a nessus file descriptor
	(nessus_register_connection, ovas_allocate_connection): Most of
	nessus_register_connection is now in the new function
	ovas_allocate_connection.
	(set_gnutls_priorities): New.  Frontend for the other set_gnutls_*
	functions.
	(verify_peer_certificate): New.  Function to verify the peer
	certificate
	(open_SSL_connection): Use set_gnutls_priorities.
	(ovas_server_context_new): New.  Function to allocate an
	ovas_server_context_t
	(ovas_server_context_free): New.  Function to free an
	ovas_server_context_t
	(ovas_server_context_attach): New.  Functin to set up SSL/TLS on a
	socket with parameters from a ovas_server_context_t

	* include/libopenvas.h: Add declarations for the new functions and
	types.  Always declare nessus_SSL_init.

2007-06-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libhosts_gatherer/hg_add_hosts.c: Backported patch from original
	nessus-libraries branch NESSUS_2_2 as committed by Renaud Deraison
	June, 25 2007. Original commit message there: "bugfix".

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_password_cb): Removed because
	it's not used anymore.

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_SSL_init): Handle errors.

2007-06-22  Bernhard Herzog  <bh@intevation.de>

	* libopenvas-config.pre.in: remove the @pcap_flag@ substitution
	from the --libs output.  The pcap options are now in EXTRA anyway
	and @pcap_flag@ is no longer substituted.

2007-06-21  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removed local copy of pcap library.

	* configure.in, Makefile, libopenvas-config.pre.in:
	Removed any handling of libpcap-nessus

	* configure: updated with new autoconf version as of Debian etch

	* libpcap-nessus/: Removed entire directory.

2007-06-21  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (nessus_install_passwd_cb): Use correct
	function name in error message

2007-06-21  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (sslerror2, sslerror)
	(nessus_install_passwd_cb): Get rid of the last actual OpenSSL
	calls.  The implementations now simply print an error message and
	do nothing.

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (open_SSL_connection): Better error
	handling for the gnutls function calls.

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c: Keep a pointer to the gnutls credentials
	struct so that it can be freed properly:
	(struct nessus_connection): New member tls_cred
	(release_connection_fd): Free tls_cred
	(open_SSL_connection): Store the credentials in the tls_cred
	member

2007-06-20  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (load_file, unload_file): New. Helper
	functions to load certificates and keys.
	(load_cert_and_key): New.  Loads certificate and key files into
	the gnuTLS credentials object.  This function supports decryption
	of private keys.
	(open_SSL_connection): use load_cert_and_key to load the
	certificate and key.  Remove the warnign about unsupported key
	decryption.  Load the CA files if given.

2007-06-14  Bernhard Herzog  <bh@intevation.de>

	First step in the code to move from OpenSSL to GnuTLS.  The code
	in network.c now uses GnuTLS instead of OpenSSL for stream
	connections.  There are still a few remnants of the OpenSSL code,
	though and code using the library will still need to link -lssl.

	* libopenvas/network.c (struct nessus_connection)
	(release_connection_fd, nessus_register_connection, sslerror)
	(nessus_SSL_init, open_SSL_connection, open_stream_connection)
	(open_stream_connection_unknown_encaps5)
	(read_stream_connection_unbuffered, write_stream_connection4)
	(stream_pending): Use GnuTLS instead of OpenSSL.
	(stream_get_ssl): Now always returns NULL since there's no SSL*
	associated with a stream anymore.  See the comments in the code
	for some of the implications of this.
	(tlserror, set_gnutls_sslv23, set_gnutls_sslv3, set_gnutls_tlsv1):
	New functions for the GnuTLS support.

2007-06-04  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (struct nessus_connection)
	(open_SSL_connection, write_stream_connection4): Remove
	nessus_connection member last_ssl_err because it's only assigned
	to, but never used.

2007-05-25  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: Renamed from CVS to SVN.

	* TODO: Some more open questions.

	* include/includes.h: Removed a nessus header file.

2007-05-23  Bernhard Herzog  <bh@intevation.de>

	* libopenvas/network.c (data_left): Removed.  The function was
	commented out and never used.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/network.c: Renamed all closesocket() to close().
	closesocket() was a remain from trying to be NT compatible.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure: updated.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Fixed dependencies for target install. This
	way now also libopenvas-config gets created during install
	from libopenvas-config.tmpl which wasn't the case before.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: Fixed name for libopenvas-config man page for installation.

2007-05-14  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile: installation target for headerfiles renamed from
	nessus to openvas.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Introduce "make dist" to create a tar-ball.

	* VERSION: Set to .CVS.

	* MANIFEST: New. List of source files for dist.

	* Makefile: New target "dist".

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus-config.pre.in: Removed.

	* libopenvas-config.pre.in: New. Replaces nessus-config.pre.in.

	* nessus-config.1: Removed.

	* libopenvas-config.1: New. Replaces nessus-config.1.

	* configure.in, Makefile: Replace nessus-config by libopenvas-config.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus-config.pre.in, Makefile: Removed DESTDIR. It looks
	pretty useless as it needs to be set in the shell.
	It was introduced in Nessus 1.3.1.

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libopenvas/plugutils.c: Removed any conditional alternatives
	for HAVE_SSL (ssl is mandatory now)

2007-05-09  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	First, intermediate step of migrating from OpenSSL to GNUTLS:
	Remove the all old stuff at the configure-level.

	* configure.in: Removed any  handling of OpenSSL and the
	conditional handling of SSL support. Inserterted mandatory
	requirement of GNUTLS.

	* configure: Updated.

	* openvas-libraries.tmpl.in, nessus-config.pre.in: Removed
	any OpenSSL handling.

2007-04-26  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Removed cygwin stuff.

2007-04-24  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in, Makefile, INSTALL_README: Removed handling of "uninstall-nessus".

	* uninstall-nessus.in: Removed.

2007-04-12  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	Removing various Windows related files.

	* README.WINDOWS, nmake.w32, nmake.bat, nessus.def,
	include/config.w32, include/ntcompat.h: Removed.

	* include/includes.h: Removed some W32-specific elements.

2007-03-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* Makefile, libopenvas/Makefile: Renaming libnessus to libopenvas.
	Fixing header from GPL to LGPL.

	* libopenvas/store.c, libopenvas/plugutils.c, libopenvas/ids_send.c,
	libopenvas/arglists.c, libopenvas/data.c, libopenvas/network.c,
	libopenvas/services.c, uninstall-nessus.in, include/includes.h:
	Added header. Renaming libnessus to libopenvas.

	* include/libnessus.h: Renamed to libopenvas.h.

	* include/libopenvas.h: New. Former libnessus.h.

2007-03-29  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* libnessus: Renamed to libopenvas.

	* libopenvas: New. Former libnessus.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* TODO: New. Keep a list of issues/ideas/plans for this module.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* openvas-libraries.tmpl.in: Added header.

	* Makefile, libhosts_gatherer/Makefile, libnessus/Makefile: Added header.
	Renamed nessus.tmpl to openvas-libraries.tmpl.

	* libpcap-nessus/Makefile.in: Renamed nessus.tmpl to openvas-libraries.tmpl.

	* configure: updated.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* nessus.tmpl.in: Removed (replaced by openvas-libraries.tmpl.in)

	* openvas-libraries.tmpl.in: Former nessus.tmpl

	* configure.in: Name change for .tmpl file.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* configure.in: Added header information.

	* ChangeLog: New. Summary of changes.

2007-03-28  Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>

	* VERSION: Changed version number to 0.9.0 to not confuse with nessus
		versioning and to make clear that for OpenVAS this is not yet stable.
